<!doctype html>
<html lang="zh" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.88.1" /><link rel="canonical" type="text/html" href="/docs/sdkreference/">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>SDK 手册 | Proxima</title>


  <meta name="description" content="介绍 Proxima Bilin Engine 所提供的 SDK，目前支持的语言有：C&#43;&#43;、Golang、Java 和 Python 等。
">
<meta property="og:title" content="SDK 手册" />
<meta property="og:description" content="介绍 Proxima Bilin Engine 所提供的 SDK，目前支持的语言有：C&#43;&#43;、Golang、Java 和 Python 等。
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/docs/sdkreference/" /><meta property="og:site_name" content="Proxima" />

<meta itemprop="name" content="SDK 手册">
<meta itemprop="description" content="介绍 Proxima Bilin Engine 所提供的 SDK，目前支持的语言有：C&#43;&#43;、Golang、Java 和 Python 等。
"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SDK 手册"/>
<meta name="twitter:description" content="介绍 Proxima Bilin Engine 所提供的 SDK，目前支持的语言有：C&#43;&#43;、Golang、Java 和 Python 等。
"/>




<link rel="preload" href="/scss/main.min.bd5285b713d3061549a6bfd34e5f4ec6775ede36672a3088260f0d420050647f.css" as="style">
<link href="/scss/main.min.bd5285b713d3061549a6bfd34e5f4ec6775ede36672a3088260f0d420050647f.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>







<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-00000000-0', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>




  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="text-uppercase font-weight-bold">Proxima</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="/docs/" ><span class="active">文档</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; 站内搜索…"
  aria-label="站内搜索…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.517d765d1103fcb3a7582103c6e5c703.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="10"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
这是本节的多页打印视图。
<a href="#" onclick="print();return false;">点击此处打印</a>.
</p><p>
<a href="/docs/sdkreference/">返回本页常规视图</a>.
</p>
</div>



<h1 class="title">SDK 手册</h1>
<div class="lead">介绍 Proxima Bilin Engine 所提供的 SDK，目前支持的语言有：C++、Golang、Java 和 Python 等。</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-6f04094d9cd5447fda36321928b28017">Python SDK</a></li>


    
  
    
    
	
<li>2: <a href="#pg-244b17a0abf8bde5ce4e9f5266f51dd4">C&#43;&#43; SDK</a></li>


    
  
    
    
	
<li>3: <a href="#pg-5e48d6247c351bba283b98e503a27497">Java SDK</a></li>


    
  
    
    
	
<li>4: <a href="#pg-3b5fc766df1bef33968337e2ac3f60d9">Golang SDK</a></li>


    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-6f04094d9cd5447fda36321928b28017">1 - Python SDK</h1>
    
	<p>目前只支持python 3.6及以上的版本。</p>
<h2 id="1-创建客户端">1. 创建客户端</h2>
<p>可以创建同步客户端或者异步客户端。</p>
<ul>
<li>同步客户端</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">pyproximabe</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#ce5c00;font-weight:bold">*</span>
<span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Client</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;127.0.0.1&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">16000</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>Proxima BE服务支持 GRPC 和 HTTP 两种协议，监听在不同的端口上。同步客户端同时支持这两种协议，默认使用GRPC协议。如果有需求，可以用下面的方式来指定协议。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">Client</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;127.0.0.1&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">16001</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;http&#39;</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><ul>
<li>异步客户端</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">pyproximabe</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#ce5c00;font-weight:bold">*</span>
<span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">AsyncClient</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">HOST</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">GRPC_PORT</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>异步客户端基于asyncio实现，除了需要await结果外，和同步客户端的使用方式完全一致。 异步客户端只支持GRPC协议。</p>
<p>同步或异步客户端支持的参数如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">__init__</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">host</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">port</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">16000</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">handler</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;grpc&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">timeout</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">host</td>
<td style="text-align:left">服务器地址，str类型</td>
</tr>
<tr>
<td style="text-align:left">port</td>
<td style="text-align:left">服务器端口，int类型</td>
</tr>
<tr>
<td style="text-align:left">handler</td>
<td style="text-align:left">协议类型，str类型，一般不需要指定。<br />同步客户端支持grpc/http，异步客户端只支持grpc。</td>
</tr>
<tr>
<td style="text-align:left">timeout</td>
<td style="text-align:left">超时时间，单位秒，float类型，默认为10。指定为None则不超时。</td>
</tr>
</tbody>
</table>
<p>使用完毕后，可以调用<code>close()</code>关闭客户端，其参数为空，返回值为None。</p>
<pre tabindex="0"><code>client.close()
</code></pre><h2 id="2-集合管理">2. 集合管理</h2>
<h3 id="21-集合创建">2.1. 集合创建</h3>
<h4 id="创建直写集合">创建直写集合</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">collection_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;iris&#39;</span>
<span style="color:#000">index_column</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">IndexColumnParam</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;length&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">IndexType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">PROXIMA_GRAPH_INDEX</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">collection_config</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">CollectionConfig</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#000">index_column</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;iris_type&#39;</span><span style="color:#000;font-weight:bold">])</span>
<span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">create_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_config</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#204a87;font-weight:bold">not</span> <span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ok</span><span style="color:#000;font-weight:bold">():</span>
    <span style="color:#8f5902;font-style:italic"># error handling</span>
    <span style="color:#000">logging</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;create collection failed, status=</span><span style="color:#4e9a06">%s</span><span style="color:#4e9a06">&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>首先，创建一个或多个索引列</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">index_column</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">IndexColumnParam</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;length&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">IndexType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">PROXIMA_GRAPH_INDEX</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>参数如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">__init__</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span>
             <span style="color:#000">name</span><span style="color:#000;font-weight:bold">,</span>
             <span style="color:#000">dimension</span><span style="color:#000;font-weight:bold">,</span>
             <span style="color:#000">index_type</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">IndexType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">PROXIMA_GRAPH_INDEX</span><span style="color:#000;font-weight:bold">,</span>
             <span style="color:#000">data_type</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">VECTOR_FP32</span><span style="color:#000;font-weight:bold">,</span>
             <span style="color:#000">extra_params</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">name</td>
<td style="text-align:left">索引列名称，str类型。</td>
</tr>
<tr>
<td style="text-align:left">dimension</td>
<td style="text-align:left">向量维度，int类型。</td>
</tr>
<tr>
<td style="text-align:left">index_type</td>
<td style="text-align:left">索引类型，<a href="#indextype">IndexType</a> 类型，默认为PROXIMA_GRAPH_INDEX。</td>
</tr>
<tr>
<td style="text-align:left">data_type</td>
<td style="text-align:left">数据类型，<a href="#datatype">DataType</a> 类型，默认为VECTOR_FP32。</td>
</tr>
<tr>
<td style="text-align:left">extra_params</td>
<td style="text-align:left">扩展参数，dict类型，默认为空。</td>
</tr>
</tbody>
</table>
<p>然后，创建<code>CollectionConfig</code>。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">collection_config</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">CollectionConfig</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#000">index_column</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;iris_type&#39;</span><span style="color:#000;font-weight:bold">])</span>
</code></pre></div><p>(python_collection_config)=
参数如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">__init__</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">index_column_params</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">forward_column_names</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">repository_config</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span>
                <span style="color:#000">max_docs_per_segment</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">):</span>

</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">collection_name</td>
<td style="text-align:left">集合名称，str类型。</td>
</tr>
<tr>
<td style="text-align:left">index_column_params</td>
<td style="text-align:left">索引列列表，List[IndexColumnParam]类型。</td>
</tr>
<tr>
<td style="text-align:left">forward_column_names</td>
<td style="text-align:left">正排列列表，List[str]类型。默认为空。</td>
</tr>
<tr>
<td style="text-align:left">repository_config</td>
<td style="text-align:left">仓库配置，DatabaseRepository类型。默认为None。</td>
</tr>
<tr>
<td style="text-align:left">max_docs_per_segment</td>
<td style="text-align:left">每个segment的最大文档数，long类型。默认为0，文档数不限。</td>
</tr>
</tbody>
</table>
<p>最后，调用client接口。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">create_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_config</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#204a87;font-weight:bold">not</span> <span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ok</span><span style="color:#000;font-weight:bold">():</span>
    <span style="color:#8f5902;font-style:italic"># error handling</span>
    <span style="color:#000">logging</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;create collection failed, status=</span><span style="color:#4e9a06">%s</span><span style="color:#4e9a06">&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><code>create_collection()</code>接收<code>CollectionConfig</code>参数，返回<a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">ProximaBeStatus</a>。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">create_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">collection_config</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><h4 id="创建数据库旁路集合">创建数据库旁路集合</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">MYSQL_PORT</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">3306</span>
<span style="color:#000">MYSQL_HOST</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">HOST</span>

<span style="color:#000">mysql_table_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;iris_table&#39;</span>
<span style="color:#000">mysql_database_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;test_db&#39;</span>
<span style="color:#000">mysql_user</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;root&#39;</span>
<span style="color:#000">mysql_password</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;root&#39;</span>

<span style="color:#000">index_column</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">IndexColumnParam</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;length&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">IndexType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">PROXIMA_GRAPH_INDEX</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">database_repository</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DatabaseRepository</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;test_repository&#39;</span><span style="color:#000;font-weight:bold">,</span>
                                         <span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#39;mysql://</span><span style="color:#4e9a06">{</span><span style="color:#000">MYSQL_HOST</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">:</span><span style="color:#4e9a06">{</span><span style="color:#000">MYSQL_PORT</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">/</span><span style="color:#4e9a06">{</span><span style="color:#000">mysql_database_name</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;</span><span style="color:#000;font-weight:bold">,</span>
                                         <span style="color:#000">mysql_table_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">mysql_user</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">mysql_password</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">collection_config</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">CollectionConfig</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#000">index_column</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;iris_type&#39;</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">database_repository</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">create_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_config</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>除了需要创建<code>DatabaseRepository</code>外，其他参数和直写集合完全相同。目前只支持mysql。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">database_repository</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DatabaseRepository</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;test_repository&#39;</span><span style="color:#000;font-weight:bold">,</span>
                                         <span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#39;mysql://</span><span style="color:#4e9a06">{</span><span style="color:#000">MYSQL_HOST</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">:</span><span style="color:#4e9a06">{</span><span style="color:#000">MYSQL_PORT</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">/</span><span style="color:#4e9a06">{</span><span style="color:#000">mysql_database_name</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;</span><span style="color:#000;font-weight:bold">,</span>
                                         <span style="color:#000">mysql_table_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">mysql_user</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">mysql_password</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>参数列表如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">__init__</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">repository_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">connection_uri</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">table_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">user</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">password</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">repository_name</td>
<td style="text-align:left">仓库名称，str类型。</td>
</tr>
<tr>
<td style="text-align:left">connection_uri</td>
<td style="text-align:left">数据库连接串，str类型，如&quot;mysql://localhost/database&quot;，不包含用户名和密码。</td>
</tr>
<tr>
<td style="text-align:left">table_name</td>
<td style="text-align:left">表名，str类型。</td>
</tr>
<tr>
<td style="text-align:left">user</td>
<td style="text-align:left">用户名，str类型。</td>
</tr>
<tr>
<td style="text-align:left">password</td>
<td style="text-align:left">数据库密码，str类型。</td>
</tr>
</tbody>
</table>
<h3 id="22-描述集合">2.2. 描述集合</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">status</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">collection_info</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">describe_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#204a87;font-weight:bold">not</span> <span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ok</span><span style="color:#000;font-weight:bold">():</span>
    <span style="color:#204a87;font-weight:bold">pass</span>  <span style="color:#8f5902;font-style:italic"># error handling</span>
<span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_info</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><code>describe_collection()</code>接收str类型的<code>collection_name</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">describe_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><p>返回值有两个</p>
<ul>
<li><a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">ProximaBeStatus</a></li>
<li><a href="#collectioninfo">CollectionInfo</a></li>
</ul>
<h3 id="23-获取集合统计信息">2.3. 获取集合统计信息</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">status</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">collection_stats</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">stats_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#204a87;font-weight:bold">not</span> <span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ok</span><span style="color:#000;font-weight:bold">():</span>
    <span style="color:#204a87;font-weight:bold">pass</span>  <span style="color:#8f5902;font-style:italic"># error handling</span>
<span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_stats</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><code>stats_collection()</code>接收str类型的<code>collection_name</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">stats_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><p>返回值有两个</p>
<ul>
<li><a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">ProximaBeStatus</a></li>
<li><a href="#collectionstats">CollectionStats</a></li>
</ul>
<h3 id="24-删除集合">2.4. 删除集合</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">drop_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><code>drop_collection()</code>接收str类型的<code>collection_name</code>，返回<a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">ProximaBeStatus</a>。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">drop_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><h3 id="25-获取集合列表">2.5. 获取集合列表</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">status</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">collections_data</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">list_collections</span><span style="color:#000;font-weight:bold">()</span>
</code></pre></div><p><code>list_collections()</code>参数列表如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">list_collections</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">repository_name</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">repository_name</td>
<td style="text-align:left">仓库名称，str类型，默认为空。参数为空时，返回所有的集合列表，否则返回指定仓库下的集合列表。</td>
</tr>
<tr>
<td style="text-align:left">返回值有两个</td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li><a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">ProximaBeStatus</a></li>
<li>List[<a href="#collectioninfo">CollectionInfo</a>]</li>
</ul>
<h2 id="3-文档管理">3. 文档管理</h2>
<h3 id="31-通用接口">3.1. 通用接口</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">struct</span>
<span style="color:#000">row_meta</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">RowMeta</span><span style="color:#000;font-weight:bold">([</span><span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">IndexColumnMeta</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;length&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;VECTOR_FP32&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">)],</span>
                                <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;iris_type&#39;</span><span style="color:#000;font-weight:bold">],</span>
                                <span style="color:#000;font-weight:bold">[</span><span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">STRING</span><span style="color:#000;font-weight:bold">])</span>
<span style="color:#000">rows</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[</span>
    <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Row</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">100001</span><span style="color:#000;font-weight:bold">,</span>
                     <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">OperationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">INSERT</span><span style="color:#000;font-weight:bold">,</span>
                     <span style="color:#000;font-weight:bold">[[</span><span style="color:#0000cf;font-weight:bold">5.9</span><span style="color:#000;font-weight:bold">,</span><span style="color:#0000cf;font-weight:bold">3.0</span><span style="color:#000;font-weight:bold">,</span><span style="color:#0000cf;font-weight:bold">5.1</span><span style="color:#000;font-weight:bold">,</span><span style="color:#0000cf;font-weight:bold">1.8</span><span style="color:#000;font-weight:bold">]],</span>
                     <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;Iris-virginica&#39;</span><span style="color:#000;font-weight:bold">]),</span>
    <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Row</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">100002</span><span style="color:#000;font-weight:bold">,</span>
                     <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">OperationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">INSERT</span><span style="color:#000;font-weight:bold">,</span>
                     <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;[5.9,3.0,5.1,1.8]&#39;</span><span style="color:#000;font-weight:bold">],</span>
                     <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;Iris-virginica&#39;</span><span style="color:#000;font-weight:bold">]),</span>
    <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Row</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10002</span><span style="color:#000;font-weight:bold">,</span>
                     <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">OperationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">UPDATE</span><span style="color:#000;font-weight:bold">,</span>
                     <span style="color:#000;font-weight:bold">[</span><span style="color:#000">struct</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">pack</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&lt;4f&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5.9</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5.1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.8</span><span style="color:#000;font-weight:bold">)],</span>
                     <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;Iris-virginica&#39;</span><span style="color:#000;font-weight:bold">]),</span>
    <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Row</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10003</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">OperationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DELETE</span><span style="color:#000;font-weight:bold">),</span>
<span style="color:#000;font-weight:bold">]</span>
<span style="color:#000">write_request</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">WriteRequest</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rows</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row_meta</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">write</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">write_request</span><span style="color:#000;font-weight:bold">)</span>

</code></pre></div><p>首先，创建<code>WriteRequest.RowMeta</code>，描述插入行的数据类型等信息。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">row_meta</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">RowMeta</span><span style="color:#000;font-weight:bold">([</span><span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">IndexColumnMeta</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;length&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;VECTOR_FP32&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">)],</span>
                                <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;iris_type&#39;</span><span style="color:#000;font-weight:bold">],</span>
                                <span style="color:#000;font-weight:bold">[</span><span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">STRING</span><span style="color:#000;font-weight:bold">])</span>
</code></pre></div><p><code>WriteRequest.IndexColumnMeta</code>的参数如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">__init__</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">data_type</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">dimension</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">name</td>
<td style="text-align:left">索引列名称，str类型。</td>
</tr>
<tr>
<td style="text-align:left">data_type</td>
<td style="text-align:left">数据类型，<a href="#datatype">DataType</a> 类型。</td>
</tr>
<tr>
<td style="text-align:left">dimension</td>
<td style="text-align:left">向量维度，int类型。</td>
</tr>
<tr>
<td style="text-align:left"><code>WriteRequest.RowMeta</code>的参数如下</td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">__init__</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span>
             <span style="color:#000">index_column_metas</span><span style="color:#000;font-weight:bold">,</span>
             <span style="color:#000">forward_column_names</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span>
             <span style="color:#000">forward_column_types</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">index_column_metas</td>
<td style="text-align:left">索引列列表，List[WriteRequest.IndexColumnMeta]类型。</td>
</tr>
<tr>
<td style="text-align:left">forward_column_names</td>
<td style="text-align:left">正排列名称列表，List[str]。默认为空。</td>
</tr>
<tr>
<td style="text-align:left">forward_column_types</td>
<td style="text-align:left">正排列类型列表，List[DataType]。默认为空。</td>
</tr>
</tbody>
</table>
<p>然后创建<code>WriteRequest.Row</code>。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">Row</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">100001</span><span style="color:#000;font-weight:bold">,</span>
                     <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">OperationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">INSERT</span><span style="color:#000;font-weight:bold">,</span>
                     <span style="color:#000;font-weight:bold">[[</span><span style="color:#0000cf;font-weight:bold">5.9</span><span style="color:#000;font-weight:bold">,</span><span style="color:#0000cf;font-weight:bold">3.0</span><span style="color:#000;font-weight:bold">,</span><span style="color:#0000cf;font-weight:bold">5.1</span><span style="color:#000;font-weight:bold">,</span><span style="color:#0000cf;font-weight:bold">1.8</span><span style="color:#000;font-weight:bold">]],</span>
                     <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;Iris-virginica&#39;</span><span style="color:#000;font-weight:bold">]),</span>
</code></pre></div><p><code>WriteRequest.Row</code>的参数如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">__init__</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span>
              <span style="color:#000">primary_key</span><span style="color:#000;font-weight:bold">,</span>
              <span style="color:#000">operation_type</span><span style="color:#000;font-weight:bold">,</span>
              <span style="color:#000">index_column_values</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span>
              <span style="color:#000">forward_column_values</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span>
              <span style="color:#000">lsn_context</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">primary_key</td>
<td style="text-align:left">主键，long类型。</td>
</tr>
<tr>
<td style="text-align:left">operation_type</td>
<td style="text-align:left">操作类型， <a href="#writerequestoperationtype">WriteRequest.OperationType</a> 类型。</td>
</tr>
<tr>
<td style="text-align:left">index_column_values</td>
<td style="text-align:left">索引列的值列表，list类型，operation_type为删除时不需要指定。支持三种类型<br /> <ul><li>向量list，如[1.0, 2.0, 3.0]</li><li>json数组str，如&quot;[1.0,2.0,3.0]&quot;</li><li>bytes，必须为小端字节序。</li></ul></td>
</tr>
<tr>
<td style="text-align:left">forward_column_values</td>
<td style="text-align:left">正排列的值列表，list类型。</td>
</tr>
<tr>
<td style="text-align:left">lsn_context</td>
<td style="text-align:left">日志序列号上下文，<a href="#lsncontext">LsnContext</a>类型，默认为空。一般不需要设置。</td>
</tr>
<tr>
<td style="text-align:left">然后创建<code>WriteRequest</code></td>
<td></td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">write_request</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">WriteRequest</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rows</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">row_meta</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p>WriteRequest参数如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">__init__</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span>
             <span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span>
             <span style="color:#000">rows</span><span style="color:#000;font-weight:bold">,</span>
             <span style="color:#000">row_meta</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span>
             <span style="color:#000">request_id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span>
             <span style="color:#000">magic_number</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">collection_name</td>
<td style="text-align:left">集合名称，str类型。</td>
</tr>
<tr>
<td style="text-align:left">rows</td>
<td style="text-align:left">文档列表，List[WriteRequest.Row]类型。</td>
</tr>
<tr>
<td style="text-align:left">row_meta</td>
<td style="text-align:left">文档元数据，WriteRequest.RowMeta类型。如果所有的operation_type都为DELETE，不需要指定。</td>
</tr>
<tr>
<td style="text-align:left">request_id</td>
<td style="text-align:left">请求id，str类型，默认为空。一般不需要设置。</td>
</tr>
<tr>
<td style="text-align:left">magic_number</td>
<td style="text-align:left">服务端魔数，long类型，默认为0。一般不需要设置。</td>
</tr>
</tbody>
</table>
<p>最后调用client接口。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">write</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">write_request</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><code>write()</code>接收<code>WriteRequest</code>参数，返回<a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">ProximaBeStatus</a>。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">write</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">write_request</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><h3 id="32-删除接口">3.2. 删除接口</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">delete_document_by_keys</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">10001</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">10002</span><span style="color:#000;font-weight:bold">])</span>
</code></pre></div><p>在只需要删除时，python sdk提供了简化接口，只需要指定集合名称和主键列表。
参数如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">delete_document_by_keys</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">primary_keys</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">collection_name</td>
<td style="text-align:left">集合名称，str类型。</td>
</tr>
<tr>
<td style="text-align:left">primary_keys</td>
<td style="text-align:left">主键列表，List[long]类型。</td>
</tr>
<tr>
<td style="text-align:left"><code>delete_document_by_keys()</code>返回值为<a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">ProximaBeStatus</a>。</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="4-文档查询">4. 文档查询</h2>
<h3 id="41-向量查询">4.1. 向量查询</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">status</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">knn_res</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span>
                               <span style="color:#4e9a06">&#39;length&#39;</span><span style="color:#000;font-weight:bold">,</span>
                               <span style="color:#000;font-weight:bold">[[</span><span style="color:#0000cf;font-weight:bold">5.1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3.5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.4</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.2</span><span style="color:#000;font-weight:bold">],</span>
                                         <span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">5.5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2.3</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.3</span><span style="color:#000;font-weight:bold">]],</span>
                               <span style="color:#4e9a06">&#39;VECTOR_FP32&#39;</span><span style="color:#000;font-weight:bold">,</span>
                               <span style="color:#000">topk</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">result</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#204a87">enumerate</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">knn_res</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">results</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#39;Query: </span><span style="color:#4e9a06">{</span><span style="color:#000">i</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">doc</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">result</span><span style="color:#000;font-weight:bold">:</span>
        <span style="color:#000">forward_values</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;,&#39;</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">join</span><span style="color:#000;font-weight:bold">(</span>
            <span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#39;</span><span style="color:#4e9a06">{</span><span style="color:#000">k</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">=</span><span style="color:#4e9a06">{</span><span style="color:#000">v</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;</span> <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">k</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">v</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">doc</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">forward_column_values</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">items</span><span style="color:#000;font-weight:bold">())</span>
        <span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span>
            <span style="color:#4e9a06">f</span><span style="color:#4e9a06">&#39;    primary_key=</span><span style="color:#4e9a06">{</span><span style="color:#000">doc</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">primary_key</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">, score=</span><span style="color:#4e9a06">{</span><span style="color:#000">doc</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">score</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">, forward_column_values=[</span><span style="color:#4e9a06">{</span><span style="color:#000">forward_values</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">]&#39;</span>
        <span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><code>query()</code>的参数如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">query</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span>
          <span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span>
          <span style="color:#000">column_name</span><span style="color:#000;font-weight:bold">,</span>
          <span style="color:#000">features</span><span style="color:#000;font-weight:bold">,</span>
          <span style="color:#000">data_type</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span>
          <span style="color:#000">dimension</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span>
          <span style="color:#000">batch_count</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span>
          <span style="color:#000">topk</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">,</span>
          <span style="color:#000">is_linear</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">False</span><span style="color:#000;font-weight:bold">,</span>
          <span style="color:#000">radius</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span>
          <span style="color:#000">extra_params</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">None</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">collection_name</td>
<td style="text-align:left">集合名称，str类型。</td>
</tr>
<tr>
<td style="text-align:left">column_name</td>
<td style="text-align:left">索引列名称，str类型。</td>
</tr>
<tr>
<td style="text-align:left">features</td>
<td style="text-align:left">特征，支持三种类型<br /> <ul><li>小端字节序的bytes</li><li>json数组字符串，支持打平或者嵌套json数组。如2个batch的2维向量，既可以写&quot;[1.0,2.0,3.0,4.0]&ldquo;也可以写&rdquo;[[1.0,2.0],[3.0,4.0]]&quot;</li><li>向量列表，如[[5.1, 3.5, 1.4, 0.2], [5.5, 2.3, 4.0, 1.3]]</li></ul></td>
</tr>
<tr>
<td style="text-align:left">data_type</td>
<td style="text-align:left">数据类型，<a href="#datatype">DataType</a> 类型。默认为空。<ul><li>bytes类型的特征允许为空，使用集合创建时的数据类型。</li><li>向量列表类型的特征时必须设置。</li></ul></td>
</tr>
<tr>
<td style="text-align:left">dimension</td>
<td style="text-align:left">向量维度，int类型。默认为空。<ul><li>bytes类型的特征必须设置。</li><li>向量列表类型的特征时支持自动推导。</li></ul></td>
</tr>
<tr>
<td style="text-align:left">batch_count</td>
<td style="text-align:left">batch大小，int类型。默认为空。<ul><li>bytes类型的特征必须设置。</li><li>向量列表类型的特征支持自动推导。</li></ul></td>
</tr>
<tr>
<td style="text-align:left">topk</td>
<td style="text-align:left">单条查询向量返回的结果数，int类型。默认为100。</td>
</tr>
<tr>
<td style="text-align:left">is_linear</td>
<td style="text-align:left">是否做线性查找，bool类型。默认为False，基于索引做查找。</td>
</tr>
<tr>
<td style="text-align:left">radius</td>
<td style="text-align:left">搜索半径，只返回以搜索向量为球心的球体内的向量，float类型。默认为0.0，搜索半径不限。</td>
</tr>
<tr>
<td style="text-align:left">extra_params</td>
<td style="text-align:left">扩展参数，dict类型。</td>
</tr>
<tr>
<td style="text-align:left">返回值有两个</td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li><a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">ProximaBeStatus</a></li>
<li><a href="#queryresponse">QueryResponse</a></li>
</ul>
<h3 id="42-主键查询">4.2. 主键查询</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">status</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">res</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_document_by_key</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">primary_key</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">100001</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><p><code>get_document_by_key()</code>的参数如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">get_document_by_key</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">primary_key</span><span style="color:#000;font-weight:bold">):</span>
</code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">collection_name</td>
<td style="text-align:left">集合名称，str类型。</td>
</tr>
<tr>
<td style="text-align:left">primary_key</td>
<td style="text-align:left">主键，long类型。</td>
</tr>
<tr>
<td style="text-align:left">返回值有两个</td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li><a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">ProximaBeStatus</a>。主键不存在时，status.ok() == True.</li>
<li><a href="#document">Document</a>。主键不存在时，返回None。</li>
</ul>
<h2 id="5-错误处理">5. 错误处理</h2>
<h4 id="错误处理">错误处理</h4>
<p>python sdk接口一般会返回<code>ProximaBeStatus</code>类型，其包含两个属性</p>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">code</td>
<td style="text-align:left">错误码，int类型。</td>
</tr>
<tr>
<td style="text-align:left">reason</td>
<td style="text-align:left">错误详情，str类型。</td>
</tr>
</tbody>
</table>
<p>可以通过<code>ok()</code>接口来判断是否成功。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">ok</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">code</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span>
</code></pre></div><pre tabindex="0"><code class="language-{admonition}" data-lang="{admonition}">:class: warning
请求服务端成功时才会返回ProximaBeStatus，如果客户端参数检查失败或者网络有问题，会抛出ProximaSeException异常。
</code></pre><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">ProximaSeException</span><span style="color:#000;font-weight:bold">(</span><span style="color:#c00;font-weight:bold">Exception</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#204a87;font-weight:bold">pass</span>
</code></pre></div><h2 id="6-类型定义">6. 类型定义</h2>
<h3 id="indextype">IndexType</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">IndexType</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">IntEnum</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#000">UNDEFINED</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span>
    <span style="color:#000">PROXIMA_GRAPH_INDEX</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span>
</code></pre></div><h3 id="datatype">DataType</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">IntEnum</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#000">UNDEFINED</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span>
    <span style="color:#000">BINARY</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span>
    <span style="color:#000">STRING</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span>
    <span style="color:#000">BOOL</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">3</span>
    <span style="color:#000">INT32</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">4</span>
    <span style="color:#000">INT64</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span>
    <span style="color:#000">UINT32</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">6</span>
    <span style="color:#000">UINT64</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">7</span>
    <span style="color:#000">FLOAT</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">8</span>
    <span style="color:#000">DOUBLE</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">9</span>
    <span style="color:#000">VECTOR_BINARY32</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">20</span>
    <span style="color:#000">VECTOR_BINARY64</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">21</span>
    <span style="color:#000">VECTOR_FP16</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">22</span>
    <span style="color:#000">VECTOR_FP32</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">23</span>
    <span style="color:#000">VECTOR_FP64</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">24</span>
    <span style="color:#000">VECTOR_INT4</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">25</span>
    <span style="color:#000">VECTOR_INT8</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">26</span>
    <span style="color:#000">VECTOR_INT16</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">27</span>
</code></pre></div><h3 id="writerequestoperationtype">WriteRequest.OperationType</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">OperationType</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">IntEnum</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#000">INSERT</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span>
    <span style="color:#000">UPDATE</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span>
    <span style="color:#000">DELETE</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span>
</code></pre></div><h3 id="document">Document</h3>
<p><code>Document</code> 包含以下属性</p>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">primary_key</td>
<td style="text-align:left">主键，long类型。</td>
</tr>
<tr>
<td style="text-align:left">score</td>
<td style="text-align:left">分值，即距离查询向量的距离，float类型。</td>
</tr>
<tr>
<td style="text-align:left">forward_column_values</td>
<td style="text-align:left">正排名称到值的映射，dict类型。</td>
</tr>
</tbody>
</table>
<h3 id="queryresponse">QueryResponse</h3>
<p><code>QueryResponse</code>包含以下属性</p>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">results</td>
<td style="text-align:left">结果列表，List[List[<a href="#document">Document</a>]]类型。第一重list表示多个查询向量的结果，第二重list表示每个向量的Document列表</td>
</tr>
<tr>
<td style="text-align:left">debug_info</td>
<td style="text-align:left">服务端调试信息，str类型。</td>
</tr>
<tr>
<td style="text-align:left">latency_us</td>
<td style="text-align:left">服务端统计的耗时，单位为微秒。</td>
</tr>
</tbody>
</table>
<h3 id="collectioninfo">CollectionInfo</h3>
<p><code>CollectionInfo</code>包含以下属性</p>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">collection_config</td>
<td style="text-align:left">集合配置， CollectionConfig类型。</td>
</tr>
<tr>
<td style="text-align:left">status</td>
<td style="text-align:left">集合状态，CollectionInfo.Status 类型。</td>
</tr>
<tr>
<td style="text-align:left">uuid</td>
<td style="text-align:left">集合唯一标识，str类型。</td>
</tr>
<tr>
<td style="text-align:left">latest_lsn_context</td>
<td style="text-align:left">最新日志序列号上下文， <a href="#lsncontext">LsnContext</a> 类型。</td>
</tr>
<tr>
<td style="text-align:left">magic_number</td>
<td style="text-align:left">服务端魔数，long类型。</td>
</tr>
</tbody>
</table>
<p>{ref}<code>CollectionConfig定义见这里&lt;python_collection_config&gt;</code></p>
<p><code>CollectionInfo.Status</code>定义</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Status</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">IntEnum</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#4e9a06">&#34;&#34;&#34;Collection Status&#34;&#34;&#34;</span>
    <span style="color:#000">INITIALIZED</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span>
    <span style="color:#000">SERVING</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span>
    <span style="color:#000">DROPPED</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span>
</code></pre></div><h3 id="collectionstats">CollectionStats</h3>
<p><code>CollectionStats</code>包含以下属性</p>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">collection_name</td>
<td style="text-align:left">集合名称，str类型。</td>
</tr>
<tr>
<td style="text-align:left">collection_path</td>
<td style="text-align:left">集合路径，str类型。</td>
</tr>
<tr>
<td style="text-align:left">total_doc_count</td>
<td style="text-align:left">文档总数，long类型。</td>
</tr>
<tr>
<td style="text-align:left">total_segment_count</td>
<td style="text-align:left">分段总个数，long类型。</td>
</tr>
<tr>
<td style="text-align:left">total_index_file_count</td>
<td style="text-align:left">索引文件总个数，long类型。</td>
</tr>
<tr>
<td style="text-align:left">total_index_file_size</td>
<td style="text-align:left">索引文件总大小，long类型。</td>
</tr>
<tr>
<td style="text-align:left">segment_stats</td>
<td style="text-align:left">分段统计信息，List[CollectionStats.SegmentStats]类型。</td>
</tr>
</tbody>
</table>
<p><code>CollectionStats.SegmentStats</code>包含以下属性</p>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">segment_id</td>
<td style="text-align:left">段id，int类型。</td>
</tr>
<tr>
<td style="text-align:left">state</td>
<td style="text-align:left">段状态，CollectionStats.SegmentState类型。</td>
</tr>
<tr>
<td style="text-align:left">doc_count</td>
<td style="text-align:left">文档数，long类型。</td>
</tr>
<tr>
<td style="text-align:left">index_file_count</td>
<td style="text-align:left">索引文件个数，long类型。</td>
</tr>
<tr>
<td style="text-align:left">index_file_size</td>
<td style="text-align:left">索引文件大小，long类型。</td>
</tr>
<tr>
<td style="text-align:left">min_doc_id</td>
<td style="text-align:left">当前分段的最小文档id，long类型。</td>
</tr>
<tr>
<td style="text-align:left">max_doc_id</td>
<td style="text-align:left">当前分段的最大文档id，long类型。</td>
</tr>
<tr>
<td style="text-align:left">min_primary_key</td>
<td style="text-align:left">当前分段的最小主键，long类型。</td>
</tr>
<tr>
<td style="text-align:left">max_primary_key</td>
<td style="text-align:left">当前分段的最大主键，long类型。</td>
</tr>
<tr>
<td style="text-align:left">min_timestamp</td>
<td style="text-align:left">当前分段的最小时间戳，long类型。</td>
</tr>
<tr>
<td style="text-align:left">max_timestamp</td>
<td style="text-align:left">当前分段的最大时间戳，long类型。</td>
</tr>
<tr>
<td style="text-align:left">min_lsn</td>
<td style="text-align:left">当前分段的最小日志序列号，long类型。</td>
</tr>
<tr>
<td style="text-align:left">max_lsn</td>
<td style="text-align:left">当前分段的最大日志序列号，long类型。</td>
</tr>
<tr>
<td style="text-align:left">segment_path</td>
<td style="text-align:left">段文件路径，str类型。</td>
</tr>
</tbody>
</table>
<p><code>CollectionStats.SegmentState</code>定义如下</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">SegmentState</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">IntEnum</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#000">CREATED</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span>
    <span style="color:#000">WRITING</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span>
    <span style="color:#000">DUMPING</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span>
    <span style="color:#000">COMPACTING</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">3</span>
    <span style="color:#000">PERSIST</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">4</span>
</code></pre></div><h3 id="lsncontext">LsnContext</h3>
<p><code>LsnContext</code> 包含以下属性</p>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">lsn</td>
<td style="text-align:left">序列号，long类型。</td>
</tr>
<tr>
<td style="text-align:left">context</td>
<td style="text-align:left">上下文，str类型。</td>
</tr>
</tbody>
</table>
<h2 id="7-其他示例">7. 其他示例</h2>
<ul>
<li><a href="/data/python-examples/example.py">直写集合示例</a></li>
<li><a href="/data/python-examples/mysql_example.py">mysql旁路集合示例</a></li>
<li><a href="/data/python-examples/example_async.py">异步直写集合示例</a></li>
</ul>
<h2 id="8-python-api-reference">8. Python API Reference</h2>
<!-- TODO<cdz>: 添加相应的 API 链接 -->
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-244b17a0abf8bde5ce4e9f5266f51dd4">2 - C&#43;&#43; SDK</h1>
    
	<p>ProximaBE的C++ SDK主要是针对用户上游C/C++模块的集成，其具备高吞吐和低负载的特点，功能上主要是包含集合管理、文档读写等能力，可以节省用户的编码成本。</p>
<p>这篇文章中，我们将介绍C++ SDK核心接口的用法以及代码示例，以协助用户更快接入。</p>
<h2 id="1-创建客户端">1. 创建客户端</h2>
<p>第一步，需要创建客户端，默认客户端采用grpc协议，且为同步调用。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&lt;iostream&gt;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic">#include</span> <span style="color:#8f5902;font-style:italic">&#34;proxima_searcher_client.h&#34;</span><span style="color:#8f5902;font-style:italic">
</span><span style="color:#8f5902;font-style:italic"></span>
<span style="color:#204a87;font-weight:bold">using</span> <span style="color:#000">proxima</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">be</span><span style="color:#000;font-weight:bold">;</span>

<span style="color:#8f5902;font-style:italic">// 默认类型客户端
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ProximaSearchClient</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Create</span><span style="color:#000;font-weight:bold">();</span>
</code></pre></div><p>第二步，创建完客户端之后，我们需要显示连接ProximaBE服务:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">// 设置连接参数，注意这里需要填写grpc协议监听端口
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ChannelOptions</span> <span style="color:#000">options</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;127.0.0.1:16000&#34;</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#8f5902;font-style:italic">// 连接服务端
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">connect</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">options</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cerr</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Connect server failed.&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>我们在连接过程中，除了简单的测试rpc连通性之外，还会与server校验版本信息，确保兼容性。</p>
<p>客户端所有接口，都会返回Status，用户需要检查status.code是否正常，其结构如下:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000">Status</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#8f5902;font-style:italic">/// 错误码，0代表成功，其它非0代表调用错误
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">code</span><span style="color:#000;font-weight:bold">;</span>
  
  <span style="color:#8f5902;font-style:italic">/// 错误原因, 默认为&#34;Success&#34;,否则是错误描述
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#000">reason</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>代码中涉及到其它结构以及字段，可以参见<a href="#channeloptions">ChannelOptions</a></p>
<h2 id="2-集合管理">2. 集合管理</h2>
<p>我们提供了Collection的创建、删除、查询、统计等接口，供用户方便的管理集合。</p>
<h3 id="21-创建collection">2.1. 创建Collection</h3>
<p>创建一个名为Plants的集合，其中正排列为价格&quot;price&quot;以及描述&quot;description&quot;，索引列为向量列，存储4维float类型</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/// 描述Collection的具体格式
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">CollectionConfig</span> <span style="color:#000">config</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">config</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">collection_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;Plants&#34;</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">config</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">forward_columns</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;Price&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Description&#34;</span><span style="color:#000;font-weight:bold">};</span>
<span style="color:#000">config</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">index_columns</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#000">IndexColumnParam</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;ImageVector&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">VECTOR_FP32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">)}</span>

<span style="color:#8f5902;font-style:italic">/// 创建Collection
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">create_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">config</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cerr</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Create collection failed.&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>集合配置详细信息请参考: <a href="#collectionconfig">CollectionConfig</a></p>
<h3 id="22-查询collection">2.2. 查询Collection</h3>
<p>创建完集合之后，我们可以使用查询接口查看其状态。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/// 获取CollectionInfo
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">CollectionInfo</span> <span style="color:#000">collection_info</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">describe_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Plants&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">collection_info</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cerr</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Get collection info failed.&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#8f5902;font-style:italic">/// 打印CollectionInfo
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">collection_info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">collection_name</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">collection_info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">collection_status</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">collection_info</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">uuid</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">......</span>
</code></pre></div><p>除此之外，我们还可以将所有Collection信息一次性列出来</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/// 获取所有的Collection信息
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">CollectionInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">collection_infos</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">list_collections</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">collection_infos</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cerr</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;List collection infos failed.&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>返回的集合信息详细字段请参考: <a href="#collectioninfo">CollectionInfo</a></p>
<h3 id="23-统计collection">2.3. 统计Collection</h3>
<p>Collection经过一段时间的读写之后，我们可以通过统计接口观察其装载的文档数据。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/// 获取CollectionStats
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">CollectionStats</span> <span style="color:#000">collection_stats</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">stats_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Plants&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">collection_stats</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cerr</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Get collection statistics failed.&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#8f5902;font-style:italic">/// 打印CollectionStats
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">collection_stats</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">collection_name</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">collection_stats</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">total_doc_count</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">collection_stats</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">total_segment_cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">.....</span>
</code></pre></div><p>集合统计详细字段信息请参考: <a href="#collectionstats">CollectionStats</a></p>
<h3 id="24-删除collection">2.4. 删除Collection</h3>
<p>Collection完成其历史使命后，我们可以彻底删除掉某个collection。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/// 删除集合
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">drop_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Plants&#34;</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cerr</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Drop collection failed.&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h2 id="3-文档管理">3. 文档管理</h2>
<p>对于某一个集合而言，我们提供增加、更新、删除文档的接口，同时支持批量模式。</p>
<h3 id="31-插入文档">3.1. 插入文档</h3>
<p>我们在之前已经创建完成的名为&quot;Plants&quot;的集合中，插入100条数据</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/// 创建一个写入请求
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">write_request</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Create</span><span style="color:#000;font-weight:bold">();</span>

<span style="color:#8f5902;font-style:italic">/// 设置集合以及文档数据格式
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">write_request</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_collection_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Plants&#34;</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">write_request</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">add_forward_columns</span><span style="color:#000;font-weight:bold">({</span><span style="color:#4e9a06">&#34;Price&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Description&#34;</span><span style="color:#000;font-weight:bold">});</span>
<span style="color:#000">write_request</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">add_index_column</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;ImageVector&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">VECTOR_FP32</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#8f5902;font-style:italic">/// 批量填充100条文档数据
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">write_request</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">add_row</span><span style="color:#000;font-weight:bold">();</span>
  <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_primary_key</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
  <span style="color:#8f5902;font-style:italic">/// 设置为插入操作
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_operation_type</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">OperationType</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">INSERT</span><span style="color:#000;font-weight:bold">);</span>
  <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">add_forward_value</span><span style="color:#000;font-weight:bold">((</span><span style="color:#204a87;font-weight:bold">float</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">0.1f</span><span style="color:#000;font-weight:bold">);</span>
  <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">add_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;iris with number &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">to_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">));</span>
  <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">add_index_value</span><span style="color:#000;font-weight:bold">({</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">});</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#8f5902;font-style:italic">/// 写入到服务端
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">write</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">write_request</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cerr</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Write records failed.&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>在上述参考代码中，有几点值得注意:</p>
<ul>
<li>
<p>设置文档数据格式。 这里最早其实在创建Collection时候，我们填写过一次，这里需要再次设置的主要原因有两个。 第一个是由于我们未来会支持实时量化的能力，可能用户配置的类型与输入类型不一致，使用我们动态转换的能力。第二个则是我们可以基于这个信息做二次校验，防止插入数据格式错误。</p>
</li>
<li>
<p>批量模式。 理论上在一个WriteRequest中我们可以组合任意多的文档，但由于会增大单个网络请求包大小，一般还是建议用户根据实际情况进行限制。</p>
</li>
</ul>
<h3 id="32-更新文档">3.2. 更新文档</h3>
<p>更新过程基本与插入过程一致，仅改变文档的操作类型即可。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#000;font-weight:bold">.....</span>
<span style="color:#8f5902;font-style:italic">/// 批量更新100条文档数据
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">write_request</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">add_row</span><span style="color:#000;font-weight:bold">();</span>
  <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_primary_key</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
  <span style="color:#8f5902;font-style:italic">/// 设置为更新操作
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_operation_type</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">OperationType</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">UPDATE</span><span style="color:#000;font-weight:bold">);</span>
  <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">add_forward_value</span><span style="color:#000;font-weight:bold">((</span><span style="color:#204a87;font-weight:bold">float</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">0.2f</span><span style="color:#000;font-weight:bold">);</span>
  <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">add_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;iris with number &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">to_string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">));</span>
  <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">add_index_value</span><span style="color:#000;font-weight:bold">({</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span><span style="color:#000;font-weight:bold">});</span>
<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">......</span>
</code></pre></div><blockquote>
<p><strong>NOTE</strong>: 值得注意的是，目前我们实际实现中采取的是标记删除的模式，更新=删除+新增，而删除占比过高会极大影响查询性能，这一点用户务必注意。</p>
</blockquote>
<p>写入请求的详细信息可以参考: <a href="#writerequest">WriteRequest</a></p>
<h3 id="33-删除文档">3.3. 删除文档</h3>
<p>删除过程依然可以复用上述的代码结构，如果批量请求中没有插入、更新请求，那么代码可以极大简化。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/// 创建一个写入请求
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">write_request</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Create</span><span style="color:#000;font-weight:bold">();</span>

<span style="color:#8f5902;font-style:italic">/// 设置集合以及文档数据格式
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">write_request</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_collection_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Plants&#34;</span><span style="color:#000;font-weight:bold">);</span>

<span style="color:#8f5902;font-style:italic">/// 批量删除100条文档数据
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">row</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">write_request</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">add_row</span><span style="color:#000;font-weight:bold">();</span>
  <span style="color:#8f5902;font-style:italic">/// 设置为删除操作，仅需要填写primary key即可
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_primary_key</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
  <span style="color:#000">row</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_operation_type</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">OperationType</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">DELETE</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#8f5902;font-style:italic">/// 发送到服务端
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">write</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">write_request</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cerr</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Write records failed.&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><blockquote>
<p><strong>NOTE</strong>: 值得注意的是，由于我们内部采用图索引结构，删除目前采取标记删除方式，删除比例过高会带来连通性问题，影响召回和性能。我们一般不建议用户删除超过50%的文档，否则查询性能将会弱化很多。</p>
</blockquote>
<h2 id="4-文档查询">4. 文档查询</h2>
<p>最后我们希望能够在创建的&quot;Plants&quot;集合中查询这100条数据，相似度召回10条结果。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++">
<span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">query_request</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">QueryRequest</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Create</span><span style="color:#000;font-weight:bold">();</span>
<span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">query_response</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">QueryResponse</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">Create</span><span style="color:#000;font-weight:bold">();</span>

<span style="color:#8f5902;font-style:italic">/// 填充请求参数
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">query_request</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_collection_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Plants&#34;</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">knn_param</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">query_request</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">add_knn_query_param</span><span style="color:#000;font-weight:bold">();</span>
<span style="color:#000">knn_param</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_column_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;ImageVector&#34;</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">knn_param</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_topk</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">knn_param</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_features</span><span style="color:#000;font-weight:bold">({</span><span style="color:#0000cf;font-weight:bold">0.1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.3</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.4</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.5</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.6</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.7</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0.8</span><span style="color:#000;font-weight:bold">});</span>

<span style="color:#8f5902;font-style:italic">/// Knn查询
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">query</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">query_request</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">query_response</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">get</span><span style="color:#000;font-weight:bold">());</span>
<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cerr</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;Query records failed.&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">status</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">code</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#8f5902;font-style:italic">/// 打印结果
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">size_t</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">query_response</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">result_count</span><span style="color:#000;font-weight:bold">();</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">query_response</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">result</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">);</span>
  <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">size_t</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">result</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">document_count</span><span style="color:#000;font-weight:bold">();</span> <span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000;font-weight:bold">){</span>
    <span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">doc</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">result</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">document</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#8f5902;font-style:italic">/// 获取文档的primary key和相似度距离
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">doc</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">primary_key</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">doc</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">score</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
    
    <span style="color:#8f5902;font-style:italic">/// 按顺序取正排字段
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">float</span> <span style="color:#000">price</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#000">desc</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000">doc</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">get_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Price&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">price</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000">doc</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">get_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Description&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">desc</span><span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">price</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">cout</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">desc</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">endl</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>我们query同样也可以支持批量模式</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">vector_bytes</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000">size_t</span> <span style="color:#000">vector_size</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">......</span>
<span style="color:#204a87;font-weight:bold">auto</span> <span style="color:#000">knn_param</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">query_request</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">add_knn_query_param</span><span style="color:#000;font-weight:bold">();</span>
<span style="color:#000">knn_param</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_column_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;ImageVector&#34;</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">knn_param</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_topk</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">knn_param</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_features</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">vector_bytes</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">vector_size</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">knn_param</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_data_type</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">VECTOR_FP32</span><span style="color:#000;font-weight:bold">);</span>
<span style="color:#000">knn_param</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">set_dimension</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">);</span>
</code></pre></div><p>上述代码中描述了设置一段连续的bytes作为查询向量，包含100个连续的查询向量，其中每个为8维float类型。</p>
<blockquote>
<p><strong>NOTE</strong>: 还有一点值得注意的是，最终的正排数据的获取，必须按照CollectionConfig定义的顺序逐一获取，顺序不对或者类型不对，均会导致获取到空结果</p>
</blockquote>
<p>上述参考代码中查询请求和查询结果的详细信息请参考: <a href="#queryrequest">QueryRequest</a></p>
<h2 id="5-错误码">5. 错误码</h2>
<table>
<thead>
<tr>
<th>错误码</th>
<th>错误原因</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>0~9999</td>
<td>服务端错误</td>
<td></td>
</tr>
<tr>
<td>10000</td>
<td>初始化客户端失败</td>
<td></td>
</tr>
<tr>
<td>10001</td>
<td>RPC连接出错</td>
<td></td>
</tr>
<tr>
<td>10002</td>
<td>客户端与服务端版本不匹配</td>
<td></td>
</tr>
<tr>
<td>10003</td>
<td>客户端还未连接</td>
<td></td>
</tr>
<tr>
<td>10004</td>
<td>请求校验失败</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="6-接口类型">6. 接口&amp;类型</h2>
<h3 id="proximasearchclient">ProximaSearchClient</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic"> * ProximaSearchClient wrappers the operations used to call proxima search
</span><span style="color:#8f5902;font-style:italic"> * engine&#39;s service. Server may be running on another machines. It shields
</span><span style="color:#8f5902;font-style:italic"> * implementation of communication protocol and rpc details, and provide
</span><span style="color:#8f5902;font-style:italic"> * extremely high bench performance.
</span><span style="color:#8f5902;font-style:italic"> *
</span><span style="color:#8f5902;font-style:italic"> * Usage exp:
</span><span style="color:#8f5902;font-style:italic"> *     auto client = ProximaSearchClient::Create();
</span><span style="color:#8f5902;font-style:italic"> *     if (client != nullptr) {
</span><span style="color:#8f5902;font-style:italic"> *       client-&gt;connect(ChannelOptions(&#34;127.0.0.1:16000&#34;));
</span><span style="color:#8f5902;font-style:italic"> *       ...
</span><span style="color:#8f5902;font-style:italic"> *       client-&gt;create_collection();
</span><span style="color:#8f5902;font-style:italic"> *       client-&gt;close();
</span><span style="color:#8f5902;font-style:italic"> *     }
</span><span style="color:#8f5902;font-style:italic"> *
</span><span style="color:#8f5902;font-style:italic"> * Please read the examples/client_example.cc for more details.
</span><span style="color:#8f5902;font-style:italic"> *
</span><span style="color:#8f5902;font-style:italic"> * Note: the functions of this class are sync call.
</span><span style="color:#8f5902;font-style:italic"> */</span>
<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">ProximaSearchClient</span> <span style="color:#000;font-weight:bold">{</span>
 <span style="color:#204a87;font-weight:bold">public</span><span style="color:#ce5c00;font-weight:bold">:</span>
  <span style="color:#8f5902;font-style:italic">/// @brief Create a client instance and return its shared ptr.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param type Client type, only support &#34;GrpcClient&#34; now.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @return Shared ptr pointed to client impl.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @note If input type is wrong, it may return nullptr
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#000">ProximaSearchClientPtr</span> <span style="color:#000">Create</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">type</span><span style="color:#000;font-weight:bold">);</span>

  <span style="color:#8f5902;font-style:italic">//! Create a shared ptr of client with default type
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#000">ProximaSearchClientPtr</span> <span style="color:#000">Create</span><span style="color:#000;font-weight:bold">();</span>

  <span style="color:#8f5902;font-style:italic">/// @brief Try to connect remote server and establish connection.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param options Socket connection relative configs.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @return Status.code 0 means success, other means fail
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @note This function will try to send a list collections command
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///       to test if the server alive.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">Status</span> <span style="color:#000">connect</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">ChannelOptions</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">options</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Close connection to remote server and cleanup self
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">Status</span> <span style="color:#000">close</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">/// @brief Create a collection with specific config.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param config Collection config
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @return       Status.code 0 means success, other means fail
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">Status</span> <span style="color:#000">create_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">CollectionConfig</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">config</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">/// @brief Drop a collection with specific name.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param collection_name Collection name
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @return Status.code 0 means success, other means fail
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">Status</span> <span style="color:#000">drop_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">/// @brief Show the detailed information of collection.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param[in]  collection_name Collection name
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param[out] collection_info Collection information
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @return Status.code 0 means success, other means fail
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">Status</span> <span style="color:#000">describe_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span>
                                     <span style="color:#000">CollectionInfo</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">collection_info</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">/// @brief Get collection statics.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param[in]  collection_name Collection name
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param[out] stats           Collection statistics struct
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @return Status.code 0 means success, other means fail.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">Status</span> <span style="color:#000">stats_collection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">,</span>
                                  <span style="color:#000">CollectionStats</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">stats</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">/// @brief List all collections.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param[out] collections Collection infomations
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @return Status.code 0 means success, other means fail
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">Status</span> <span style="color:#000">list_collections</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">CollectionInfo</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">collections</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">/// @brief Insert/Update/Delete records.
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param request Write request
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @return Status.code means success, other means fail
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">Status</span> <span style="color:#000">write</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">WriteRequest</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">request</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">/// @brief Knn query similar results
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param[in]  request  Query request
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param[out] respnose Query response
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @return Status.code means success, other means fail
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">Status</span> <span style="color:#000">query</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">QueryRequest</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">request</span><span style="color:#000;font-weight:bold">,</span>
                       <span style="color:#000">QueryResponse</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">response</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">/// @brief Get document by primary key
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param[in]  request  Get document request
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param[out] response Get document response
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @return Status.code means success, other means fail
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">Status</span> <span style="color:#000">get_document_by_key</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">GetDocumentRequest</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">request</span><span style="color:#000;font-weight:bold">,</span>
                                     <span style="color:#000">GetDocumentResponse</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">response</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">};</span>
</code></pre></div><h3 id="channeloptions">ChannelOptions</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic"> * ChannelOptions represents the  connection config.
</span><span style="color:#8f5902;font-style:italic"> */</span>
<span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000">ChannelOptions</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#8f5902;font-style:italic">/// Host name of proximabe server
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// For exapmle: &#34;127.0.0.1:16000&#34;
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Required field
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#000">host</span><span style="color:#000;font-weight:bold">{};</span>

  <span style="color:#8f5902;font-style:italic">/// Max rpc duration out over server
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Optional field, default 1000
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000">timeout_ms</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">1000U</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">/// Max retry times when rpc failed
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Optional filed, default 3
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000">max_retry</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">3U</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">/// Connection pool count
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Optional filed, default 1
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000">connection_count</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#000">ChannelOptions</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">host</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{}</span>
<span style="color:#000;font-weight:bold">};</span>
</code></pre></div><h3 id="collectionconfig">CollectionConfig</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic"> * CollectionConfig describes the config options of collection.
</span><span style="color:#8f5902;font-style:italic"> * It includes description of index columns and forward columns.
</span><span style="color:#8f5902;font-style:italic"> * Index columns means that this column data is for knn searching.
</span><span style="color:#8f5902;font-style:italic"> * Forward columns means that this column data is just for display,
</span><span style="color:#8f5902;font-style:italic"> * which is not anticipating in search process.
</span><span style="color:#8f5902;font-style:italic"> */</span>
<span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000">CollectionConfig</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#8f5902;font-style:italic">/// Collection name, it should be unique
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Required field
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">{};</span>

  <span style="color:#8f5902;font-style:italic">/// Collection will split into serveral segments
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// This param means max doc limits in one segment
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Optional field, default 0, means no limit
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000">max_docs_per_segment</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">/// Forward column names
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Optional field
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">forward_columns</span><span style="color:#000;font-weight:bold">{};</span>

  <span style="color:#8f5902;font-style:italic">/// Index column infos
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Required filed
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">IndexColumnParam</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">index_columns</span><span style="color:#000;font-weight:bold">{};</span>

  <span style="color:#8f5902;font-style:italic">/// Database repository config
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Optional field, default empty
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">DatabaseRepository</span> <span style="color:#000">database_repository</span><span style="color:#000;font-weight:bold">{};</span>
<span style="color:#000;font-weight:bold">};</span>


<span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic"> * IndexColumnParam represents the index config of index column.
</span><span style="color:#8f5902;font-style:italic"> */</span>
<span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000">IndexColumnParam</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#8f5902;font-style:italic">/// Column name
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Required field
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#000">column_name</span><span style="color:#000;font-weight:bold">{};</span>

  <span style="color:#8f5902;font-style:italic">/// Column index type
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Optional field, default IndexType::PROXIMA_GRAPH_INDEX
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">IndexType</span> <span style="color:#000">index_type</span><span style="color:#000;font-weight:bold">{</span><span style="color:#000">IndexType</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">PROXIMA_GRAPH_INDEX</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">/// Stored data type
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Optional filed, default DataType::VECTOR_FP32
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">DataType</span> <span style="color:#000">data_type</span><span style="color:#000;font-weight:bold">{</span><span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">VECTOR_FP32</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">/// Stored data dimension
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Optional filed, default 0
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000">dimension</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">/// Extra params for column index
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// Optional field
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// For example:
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///   {&#34;ef_construction&#34;: &#34;400&#34;, &#34;ef_search&#34;: &#34;300&#34;}
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">KVPair</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">extra_params</span><span style="color:#000;font-weight:bold">{};</span>

  <span style="color:#000">IndexColumnParam</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#000">IndexColumnParam</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">DataType</span> <span style="color:#000">val2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000">val3</span><span style="color:#000;font-weight:bold">)</span>
      <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">column_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">val1</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">data_type</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">val2</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">dimension</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">val3</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{}</span>
<span style="color:#000;font-weight:bold">};</span>
</code></pre></div><h3 id="collectioninfo">CollectionInfo</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic"> * CollectionInfo describes the detailed information of collection,
</span><span style="color:#8f5902;font-style:italic"> * which is ProximaSE server returned.
</span><span style="color:#8f5902;font-style:italic"> */</span>
<span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000">CollectionInfo</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#204a87;font-weight:bold">enum</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">CollectionStatus</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">INITIALIZED</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">SERVING</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">DRPPED</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span>
  <span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">//! Collection name
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">{};</span>

  <span style="color:#8f5902;font-style:italic">//! Collection status
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">CollectionStatus</span> <span style="color:#000">collection_status</span><span style="color:#000;font-weight:bold">{</span><span style="color:#000">CollectionStatus</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">INITIALIZED</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">//! Unique uuid to a collection
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#000">collection_uuid</span><span style="color:#000;font-weight:bold">{};</span>

  <span style="color:#8f5902;font-style:italic">//! Latest record&#39;s log sequence number
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">latest_lsn</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">//! Latest record&#39;s lsn context
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#000">latest_lsn_context</span><span style="color:#000;font-weight:bold">{};</span>

  <span style="color:#8f5902;font-style:italic">//! Server magic number, generally is server started timestamp
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">magic_number</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">//! Collection&#39;s config max doc number per segment
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000">max_docs_per_segment</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">//! Collection&#39;s forward column names
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">forward_columns</span><span style="color:#000;font-weight:bold">{};</span>

  <span style="color:#8f5902;font-style:italic">//! Collection&#39;s index column params
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">IndexColumnParam</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">index_columns</span><span style="color:#000;font-weight:bold">{};</span>

  <span style="color:#8f5902;font-style:italic">//! Collection&#39;s database repository information
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">DatabaseRepository</span> <span style="color:#000">database_repository</span><span style="color:#000;font-weight:bold">{};</span>
<span style="color:#000;font-weight:bold">};</span>
</code></pre></div><h3 id="collectionstats">CollectionStats</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic"> * CollectionStats describes the detailed stastistics of collection
</span><span style="color:#8f5902;font-style:italic"> */</span>
<span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000">CollectionStats</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic">   * Segment state
</span><span style="color:#8f5902;font-style:italic">   */</span>
  <span style="color:#204a87;font-weight:bold">enum</span> <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">SegmentState</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000">CREATED</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">WRITING</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">DUMPING</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">COMPACTING</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">3</span><span style="color:#000;font-weight:bold">,</span>
    <span style="color:#000">PERSIST</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">4</span>
  <span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">/*
</span><span style="color:#8f5902;font-style:italic">   * SegmentStats describes the detailed stastistics of segment
</span><span style="color:#8f5902;font-style:italic">   */</span>
  <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000">SegmentStats</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#8f5902;font-style:italic">//! Segment unique id
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">segment_id</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

    <span style="color:#8f5902;font-style:italic">//! Segment state
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">SegmentState</span> <span style="color:#000">segment_state</span><span style="color:#000;font-weight:bold">{</span><span style="color:#000">SegmentState</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">CREATED</span><span style="color:#000;font-weight:bold">};</span>

    <span style="color:#8f5902;font-style:italic">//! Document count in this segment
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">doc_count</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

    <span style="color:#8f5902;font-style:italic">//! Index file count of this segment
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">index_file_count</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

    <span style="color:#8f5902;font-style:italic">//! Totaol index file size
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">index_file_size</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

    <span style="color:#8f5902;font-style:italic">//! Min document id
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">min_doc_id</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

    <span style="color:#8f5902;font-style:italic">//! Max document id
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">max_doc_id</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

    <span style="color:#8f5902;font-style:italic">//! Min primary key value of the segment
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">min_primary_key</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

    <span style="color:#8f5902;font-style:italic">//! Min primary key value of the segment
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">max_primary_key</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

    <span style="color:#8f5902;font-style:italic">//! Earliest record timestamp
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">min_timestamp</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

    <span style="color:#8f5902;font-style:italic">//! Last record timestamp
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">max_timestamp</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

    <span style="color:#8f5902;font-style:italic">//! Minimal log sequence number
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">min_lsn</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

    <span style="color:#8f5902;font-style:italic">//! Maximum log sequence number
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">max_lsn</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>
  <span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">//! Collection name
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#000">collection_name</span><span style="color:#000;font-weight:bold">{};</span>

  <span style="color:#8f5902;font-style:italic">//! Total document count of this collection
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">total_doc_count</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">//! Total segment count of this collectoin
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">total_segment_count</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">//! Total index file count
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">total_index_file_count</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">//! Total index file size
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">total_index_file_size</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">0U</span><span style="color:#000;font-weight:bold">};</span>

  <span style="color:#8f5902;font-style:italic">//! Detailed segment stastistics
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">SegmentStats</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">segment_stats</span><span style="color:#000;font-weight:bold">{};</span>
<span style="color:#000;font-weight:bold">};</span>
</code></pre></div><h3 id="writerequest">WriteRequest</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic"> * WriteRequest shows how to wrapper write request data fields.
</span><span style="color:#8f5902;font-style:italic"> *
</span><span style="color:#8f5902;font-style:italic"> * Usage exp:
</span><span style="color:#8f5902;font-style:italic"> *   WriteRequestPtr request = WriteRequest::Create();
</span><span style="color:#8f5902;font-style:italic"> *   request-&gt;set_collection_name(&#34;test_collection&#34;);
</span><span style="color:#8f5902;font-style:italic"> *   request-&gt;set_row_meta({&#34;test_column&#34;}, {});
</span><span style="color:#8f5902;font-style:italic"> *   auto row = request-&gt;add_row();
</span><span style="color:#8f5902;font-style:italic"> *   row-&gt;set_primary_key = 123;
</span><span style="color:#8f5902;font-style:italic"> *   row-&gt;set_operation_type(OperationType::OP_INSERT);
</span><span style="color:#8f5902;font-style:italic"> *   row-&gt;add_index_value({0.1, 0.2, 0.3});
</span><span style="color:#8f5902;font-style:italic"> *   ...
</span><span style="color:#8f5902;font-style:italic"> *   client-&gt;write(*request);
</span><span style="color:#8f5902;font-style:italic"> */</span>
<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">WriteRequest</span> <span style="color:#000;font-weight:bold">{</span>
 <span style="color:#204a87;font-weight:bold">public</span><span style="color:#ce5c00;font-weight:bold">:</span>
  <span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic">   * A row describes the format of one record
</span><span style="color:#8f5902;font-style:italic">   */</span>
  <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Row</span> <span style="color:#000;font-weight:bold">{</span>
   <span style="color:#204a87;font-weight:bold">public</span><span style="color:#ce5c00;font-weight:bold">:</span>
    <span style="color:#8f5902;font-style:italic">//! Set primary key, required
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_primary_key</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Set operation type, optional, default DataType::INSERT
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_operation_type</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">OperationType</span> <span style="color:#000">op_type</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Set lsn, optional, default 0
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_lsn</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">lsn</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Set lsn context, optional, default &#34;&#34;
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_lsn_context</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">lsn_context</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">/// @brief Add forward value with string type
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">/// @note  Add forward value sort must match configured
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">///        forward columns in CollectionConfig
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Add forward value with bool type
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">bool</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Add forward value with int32 type
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int32_t</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Add forward value with int64 type
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int64_t</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Add forward value with uint32 type
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Add forward value with uint64 type
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Add forward value with float type
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">float</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Add forward value with double type
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">double</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">/// @brief Add index value, vector bytes type
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">/// @note Add index value sort must match configured
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">///       index columns in CollectionConfig
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_index_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">val_len</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Add index value, vector array type
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_index_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">float</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">/// Add index value by json format
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">/// Two json format:
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">///   &#34;[0.1, 0.2, 0.3, 0.4]&#34;
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">///   &#34;[[0.1, 0.2, 0.3, 0.4], [0.5, 0.6, 0.7, 0.8]]&#34;
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_index_value_by_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">json_val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#000;font-weight:bold">};</span>
  <span style="color:#204a87;font-weight:bold">using</span> <span style="color:#000">RowPtr</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">shared_ptr</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">Row</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">;</span>

 <span style="color:#204a87;font-weight:bold">public</span><span style="color:#ce5c00;font-weight:bold">:</span>
  <span style="color:#8f5902;font-style:italic">//! Constructor
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#000">WriteRequestPtr</span> <span style="color:#000">Create</span><span style="color:#000;font-weight:bold">();</span>

  <span style="color:#8f5902;font-style:italic">//! Set collection name, required, must be unique
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_collection_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">/// @brief Add forward column in row meta
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @note Forward column names&#39; sort must match configured
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///       forward columns in CollectionConfig
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_forward_column</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">column_name</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">/// @brief Add forward columns in row meta
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @note Forward column names&#39; sort must match configured
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///       forward columns in CollectionConfig
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_forward_columns</span><span style="color:#000;font-weight:bold">(</span>
      <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">column_names</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">/// @brief Add index column in row meta
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param column_name Column name
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param data_type   Send data type
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @param dimension   Send data dimension
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">/// @note Index column names&#39; sort must match configured
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#8f5902;font-style:italic">///       index columns in CollectionConfig
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_index_column</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">column_name</span><span style="color:#000;font-weight:bold">,</span>
                                <span style="color:#000">DataType</span> <span style="color:#000">data_type</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000">dimension</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Add row data, required, can&#39;t send empty request
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">RowPtr</span> <span style="color:#000">add_row</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Set request id for tracelog, optional
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_request_id</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">request_id</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Set magic number for validation, optional
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_magic_number</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">magic_number</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">};</span>
</code></pre></div><h3 id="queryrequest">QueryRequest</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic"> * QueryRequest shows how to wrapper query data fields.
</span><span style="color:#8f5902;font-style:italic"> *
</span><span style="color:#8f5902;font-style:italic"> * Usage exp:
</span><span style="color:#8f5902;font-style:italic"> *   QueryRequestPtr request = QueryRequest::Create();
</span><span style="color:#8f5902;font-style:italic"> *   request-&gt;set_collection_name(&#34;test_colletion&#34;);
</span><span style="color:#8f5902;font-style:italic"> *   auto knn_param = request-&gt;add_knn_query_param();
</span><span style="color:#8f5902;font-style:italic"> *   knn_param-&gt;set_column_name(&#34;test_column&#34;);
</span><span style="color:#8f5902;font-style:italic"> *   knn_param-&gt;set_features({0.1, 0.2, 0.3, 0.4});
</span><span style="color:#8f5902;font-style:italic"> *   knn_param-&gt;set_batch_count(1);
</span><span style="color:#8f5902;font-style:italic"> *   knn_param-&gt;set_dimension(4);
</span><span style="color:#8f5902;font-style:italic"> *   knn_param-&gt;set_data_type(DT_VECTOR_FP32);
</span><span style="color:#8f5902;font-style:italic"> *   ...
</span><span style="color:#8f5902;font-style:italic"> *
</span><span style="color:#8f5902;font-style:italic"> */</span>
<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">QueryRequest</span> <span style="color:#000;font-weight:bold">{</span>
 <span style="color:#204a87;font-weight:bold">public</span><span style="color:#ce5c00;font-weight:bold">:</span>
  <span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic">   * KnnQueryParam describes the options of knn query
</span><span style="color:#8f5902;font-style:italic">   */</span>
  <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">KnnQueryParam</span> <span style="color:#000;font-weight:bold">{</span>
   <span style="color:#204a87;font-weight:bold">public</span><span style="color:#ce5c00;font-weight:bold">:</span>
    <span style="color:#8f5902;font-style:italic">//! Set column name, required
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_column_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Set topk, required
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_topk</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">/// Set query vector with bytes format by single
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">/// Required set
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_features</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">val_len</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Set features with vector array format by single
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_features</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">float</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Set query vector with bytes format by batch
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_features</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">size_t</span> <span style="color:#000">val_len</span><span style="color:#000;font-weight:bold">,</span>
                              <span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000">batch</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">/// Set features by json format
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">/// Two json format:
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">///   &#34;[0.1, 0.2, 0.3, 0.4]&#34;
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">///   &#34;[[0.1, 0.2, 0.3, 0.4], [0.5, 0.6, 0.7, 0.8]]&#34;
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_features_by_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">json_val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Set features by json format and by batch
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_features_by_json</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">json_val</span><span style="color:#000;font-weight:bold">,</span>
                                      <span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000">batch</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Set vector data dimension, required
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_dimension</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Set vector data type, required
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_data_type</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">DataType</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Set search radius, optional, default 0.0f not open
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_radius</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">float</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Set if use linear search, optional, default false
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_linear</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">bool</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Add extra params, like ef_search ..etc, optional
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">add_extra_param</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span>
                                 <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#000;font-weight:bold">};</span>
  <span style="color:#204a87;font-weight:bold">using</span> <span style="color:#000">KnnQueryParamPtr</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">shared_ptr</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">KnnQueryParam</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000;font-weight:bold">;</span>

 <span style="color:#204a87;font-weight:bold">public</span><span style="color:#ce5c00;font-weight:bold">:</span>
  <span style="color:#8f5902;font-style:italic">//! Constructor
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#000">QueryRequestPtr</span> <span style="color:#000">Create</span><span style="color:#000;font-weight:bold">();</span>

  <span style="color:#8f5902;font-style:italic">//! Set collection name, required
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_collection_name</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Set knn query param, required
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">QueryRequest</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">KnnQueryParamPtr</span> <span style="color:#000">add_knn_query_param</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Set debug mode, optional, default false
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">set_debug_mode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">bool</span> <span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">};</span>
</code></pre></div><h3 id="queryresponse">QueryResponse</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic"> * QueryResponse shows the format of query response.
</span><span style="color:#8f5902;font-style:italic"> */</span>
<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">QueryResponse</span> <span style="color:#000;font-weight:bold">{</span>
 <span style="color:#204a87;font-weight:bold">public</span><span style="color:#ce5c00;font-weight:bold">:</span>
  <span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic">   * Result represents a knn query&#39;s result
</span><span style="color:#8f5902;font-style:italic">   */</span>
  <span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Result</span> <span style="color:#000;font-weight:bold">{</span>
   <span style="color:#204a87;font-weight:bold">public</span><span style="color:#ce5c00;font-weight:bold">:</span>
    <span style="color:#8f5902;font-style:italic">//! Return document count
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">size_t</span> <span style="color:#000">document_count</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">//! Return document pointer of specific pos
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">DocumentPtr</span> <span style="color:#000">document</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">index</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
  <span style="color:#000;font-weight:bold">};</span>

 <span style="color:#204a87;font-weight:bold">public</span><span style="color:#ce5c00;font-weight:bold">:</span>
  <span style="color:#8f5902;font-style:italic">//! Constructor
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">static</span> <span style="color:#000">QueryResponsePtr</span> <span style="color:#000">Create</span><span style="color:#000;font-weight:bold">();</span>

  <span style="color:#8f5902;font-style:italic">//! Return debug info
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">debug_info</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Return query latency, microseconds
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">latency_us</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Return batch result count
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">size_t</span> <span style="color:#000">result_count</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Return result pointer of specific batch pos
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">QueryResponse</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">ResultPtr</span> <span style="color:#000">result</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">index</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">};</span>


<span style="color:#8f5902;font-style:italic">/**
</span><span style="color:#8f5902;font-style:italic"> * Document shows the format of knn query response
</span><span style="color:#8f5902;font-style:italic"> */</span>
<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">Document</span> <span style="color:#000;font-weight:bold">{</span>
 <span style="color:#204a87;font-weight:bold">public</span><span style="color:#ce5c00;font-weight:bold">:</span>
  <span style="color:#8f5902;font-style:italic">//! Return document primary key
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#000">primary_key</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Return calculated knn distance score
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">float</span> <span style="color:#000">score</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Return forward values count
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#000">size_t</span> <span style="color:#000">forward_count</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Get forward names
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">get_forward_names</span><span style="color:#000;font-weight:bold">(</span>
      <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">vector</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">forward_names</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Get forward value with string type
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">get_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span>
                                 <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Get forward value with bool type
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">get_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">bool</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Get forward value with int32 type
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">get_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span>
                                 <span style="color:#204a87;font-weight:bold">int32_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Get forward value with int64 type
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">get_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span>
                                 <span style="color:#204a87;font-weight:bold">int64_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Get forward value with uint32 type
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">get_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span>
                                 <span style="color:#204a87;font-weight:bold">uint32_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Get forward value with uint64 type
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">get_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span>
                                 <span style="color:#204a87;font-weight:bold">uint64_t</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Get forward value with float type
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">get_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">float</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>

  <span style="color:#8f5902;font-style:italic">//! Get forward value with double type
</span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">virtual</span> <span style="color:#204a87;font-weight:bold">void</span> <span style="color:#000">get_forward_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">std</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">string</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">double</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">val</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">;</span>
<span style="color:#000;font-weight:bold">};</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-5e48d6247c351bba283b98e503a27497">3 - Java SDK</h1>
    
	<p>本文主要介绍用户如何使用 Java SDK，来进行集合管理、文档的增删改查等功能。</p>
<h2 id="1-前提条件">1. 前提条件</h2>
<p>使用 ProximaBE 的 Java SDK，必须满足以下两点：</p>
<pre tabindex="0"><code>-  JDK 1.8 或者以上版本
-  使用 Apache Maven
</code></pre><h2 id="2-安装-java-sdk">2. 安装 Java SDK</h2>
<p>可以通过Apache Maven二方库依赖的方式，将 SDK 下载到自己的项目中。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">dependency</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>
<span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">groupId</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000">com</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">alibaba</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">proxima</span><span style="color:#ce5c00;font-weight:bold">&lt;/</span><span style="color:#000">groupId</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>
<span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">artifactId</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000">proxima</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">be</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">java</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">sdk</span><span style="color:#ce5c00;font-weight:bold">&lt;/</span><span style="color:#000">artifactId</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>
<span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">version</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">1</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">2</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">SNAPSHOT</span><span style="color:#ce5c00;font-weight:bold">&lt;/</span><span style="color:#000">version</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>
<span style="color:#ce5c00;font-weight:bold">&lt;/</span><span style="color:#000">dependency</span><span style="color:#ce5c00;font-weight:bold">&gt;</span>
</code></pre></div><h2 id="3-客户端创建">3. 客户端创建</h2>
<p>ProximaSearchClient 是ProximaBE 对外的所有接口的代理层，用户通过传入连接参数，创建该客户端对象，就可以对 ProximaBE 中的集合进行相关的操作。</p>
<h3 id="31-初始化连接参数">3.1. 初始化连接参数</h3>
<p><strong>构建类</strong>：ConnectParam.Builder</p>
<p><em>首先通过调用 ConnectParam 的 newBuilder 接口，创建出 ConnectParam 的 Builder 对象，然后依次通过Builder对象设置 ProximaBE 的 host 地址，以及 grpc 端口等信息，最终调用 Builder的 build 接口，即可构建出 ConnectParam 对象。</em></p>
<p><strong>Builder 参数说明</strong>：</p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">host</td>
<td style="text-align:left">ProximaBE对应的服务地址，String类型默认为 localhost</td>
</tr>
<tr>
<td style="text-align:left">port</td>
<td style="text-align:left">ProximaBE对应的GRPC服务端口，int类型，默认16000</td>
</tr>
<tr>
<td style="text-align:left">IdleTimeout</td>
<td style="text-align:left">GRPC链接空闲的超时时间，long类型，默认12小时</td>
</tr>
</tbody>
</table>
<h3 id="32-创建客户端对象">3.2. 创建客户端对象</h3>
<p><strong>接口</strong>：ProximaGrpcSearchClient(ConnectParam connectParam)</p>
<p><em>通过传入的 connectParam 对象创建 ProximaBE 客户端，目前支持 Grpc 协议，创建成功后返回 ProximaSearchClient 对象，目前 Client 中的接口均为同步接口。</em></p>
<p><strong>参数说明</strong>：</p>
<ul>
<li>ConnectParam：表示连接 ProximaBE 所需要的相关连接参数信息</li>
</ul>
<h3 id="33-示例">3.3. 示例</h3>
<p>创建 ProximaSearchClient 对象</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">com.alibaba.proxima.se.client.*</span><span style="color:#ce5c00;font-weight:bold">;</span>

<span style="color:#8f5902;font-style:italic">// init connect params
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ConnectParam</span> <span style="color:#000">connectParam</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ConnectParam</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withHost</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;127.0.0.1&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withPort</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">16000</span><span style="color:#ce5c00;font-weight:bold">)</span>
                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>

<span style="color:#8f5902;font-style:italic">// create client
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">ProximaSearchClient</span> <span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">ProximaGrpcSearchClient</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">connectParam</span><span style="color:#ce5c00;font-weight:bold">);</span>

</code></pre></div><h2 id="4-集合管理">4. 集合管理</h2>
<p>集合管理主要包括集合的创建、集合的查询和集合的删除等操作。</p>
<h3 id="41-创建集合">4.1. 创建集合</h3>
<h4 id="411-创建-collectionconfig">4.1.1 创建 CollectionConfig</h4>
<p><strong>构造类</strong>：CollectionConfig.Builder</p>
<p><em>首先通过调用 CollectionConfig 的 newBuilder 接口，创建出 CollectionConfig 的 Builder 对象，然后通过 Builder 对象设置集合名称、索引列信息、正排列信息等，最终调用 Builder 的 build 接口，即可构建出 CollectionConfig 对象。</em></p>
<p><strong>Builder 参数说明：</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">collectionName</td>
<td style="text-align:left">集合的名称，String类型</td>
</tr>
<tr>
<td style="text-align:left">indexColumnParams</td>
<td style="text-align:left">索引列参数列表，List<IndexColumnParam>类型，IndexColumnParam类型参数见下表</td>
</tr>
<tr>
<td style="text-align:left">forwardColumnNames</td>
<td style="text-align:left">正排列的名称列表，List<String>类型</td>
</tr>
<tr>
<td style="text-align:left">maxDocsPerSegment</td>
<td style="text-align:left">分片最大文档数，long类型，默认值为0，表示不限制单片文档数</td>
</tr>
<tr>
<td style="text-align:left">databaseRepository</td>
<td style="text-align:left">数据库源相关配置，如果是数据库旁路集合，需要配置该选项，目前只支持 mysql 数据库</td>
</tr>
</tbody>
</table>
<p><strong>IndexColumnParam 参数:</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">columnName</td>
<td style="text-align:left">索引列名称，String 类型</td>
</tr>
<tr>
<td style="text-align:left">indexType</td>
<td style="text-align:left">索引类型，IndexType 类型，目前支持 PROXIMA_GRAPH_INDEX 类型索引</td>
</tr>
<tr>
<td style="text-align:left">dataType</td>
<td style="text-align:left">索引列数据类型，DataType 类型</td>
</tr>
<tr>
<td style="text-align:left">dimension</td>
<td style="text-align:left">索引的维度，int 类型</td>
</tr>
<tr>
<td style="text-align:left">extraParams</td>
<td style="text-align:left">其它的参数，Map类型</td>
</tr>
</tbody>
</table>
<h4 id="412-调用创建接口">4.1.2 调用创建接口</h4>
<p><strong>接口：</strong> Status <strong>createCollection</strong>(CollectionConfig collectionConfig)</p>
<p><em>根据参数 CollectionConfig 对象创建集合，返回值为 Status 对象，表示集合创建成功与否，如果传入的 CollectionConfig 对象非法，会抛出 ProximaBEException 异常。</em></p>
<p><strong>参数说明：</strong></p>
<ul>
<li>collectionConfig：其中包含了集合的基础配置信息，主要有集合名称、索引列信息、正排列名称列表等。</li>
</ul>
<p><strong>返回值：</strong></p>
<ul>
<li>Status：表示创建成功与否，其中包含错误码和错误描述</li>
</ul>
<h4 id="413-示例">4.1.3 示例</h4>
<p><strong>示例 1</strong>：创建一个带有两个正排列，以及单个向量索引列的集合</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">createCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaSearchClient</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">String</span> <span style="color:#000">collectionName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
        <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">dimension</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">8</span><span style="color:#ce5c00;font-weight:bold">;</span>

        <span style="color:#8f5902;font-style:italic">// create collection builder
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">CollectionConfig</span> <span style="color:#000">config</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">CollectionConfig</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withCollectionName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">collectionName</span><span style="color:#ce5c00;font-weight:bold">)</span>                            <span style="color:#8f5902;font-style:italic">// set collection name
</span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withForwardColumnNames</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">Arrays</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">asList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;forward1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;forward2&#34;</span><span style="color:#ce5c00;font-weight:bold">))</span> <span style="color:#8f5902;font-style:italic">// set forward column names
</span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addIndexColumnParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;index1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">VECTOR_FP32</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">dimension</span><span style="color:#ce5c00;font-weight:bold">)</span><span style="color:#8f5902;font-style:italic">// add one index column param
</span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>                                                      <span style="color:#8f5902;font-style:italic">// build the CollectionConfig
</span><span style="color:#8f5902;font-style:italic"></span>
        <span style="color:#8f5902;font-style:italic">// call create collection interface
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">config</span><span style="color:#ce5c00;font-weight:bold">);</span>
            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">ok</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
                <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;============== Create collection success. ================&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
                <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">;</span>
            <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#ce5c00;font-weight:bold">{</span>
                <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Create collection failed.&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">toString</span><span style="color:#ce5c00;font-weight:bold">());</span>
                <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
            <span style="color:#ce5c00;font-weight:bold">}</span>
        <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaBEException</span> <span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>
    <span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><p><strong>示例 2</strong>：创建一个带有两个正排列、单个向量索引列、以及作为Mysql 数据旁路的集合</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">createCollectionWithRepo</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaSearchClient</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#000">String</span> <span style="color:#000">collectionName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;collection2&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">dimension</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">8</span><span style="color:#ce5c00;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">// create database repository
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">DatabaseRepository</span> <span style="color:#000">repo</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">DatabaseRepository</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withConnectionUri</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;mysql://host.com:8080/mysql_database&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>  <span style="color:#8f5902;font-style:italic">// set connection uri
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withTableName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;mysql_table1&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>                              <span style="color:#8f5902;font-style:italic">// set table name
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withRepositoryName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;mysql_repo&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>                           <span style="color:#8f5902;font-style:italic">// set repository name
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withUser</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;root&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>                                           <span style="color:#8f5902;font-style:italic">// set user name
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withPassword</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;root&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>                                       <span style="color:#8f5902;font-style:italic">// set password
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>

    <span style="color:#8f5902;font-style:italic">// create collection builder
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">CollectionConfig</span> <span style="color:#000">config</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">CollectionConfig</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withCollectionName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">collectionName</span><span style="color:#ce5c00;font-weight:bold">)</span>                            <span style="color:#8f5902;font-style:italic">// set collection name
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withForwardColumnNames</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">Arrays</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">asList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;forward1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;forward2&#34;</span><span style="color:#ce5c00;font-weight:bold">))</span> <span style="color:#8f5902;font-style:italic">// set forward column name list
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addIndexColumnParam</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;index1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">VECTOR_FP32</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">dimension</span><span style="color:#ce5c00;font-weight:bold">)</span><span style="color:#8f5902;font-style:italic">// add one index column param
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withDatabaseRepository</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">repo</span><span style="color:#ce5c00;font-weight:bold">)</span>                                  <span style="color:#8f5902;font-style:italic">// set database repoistory
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>

    <span style="color:#8f5902;font-style:italic">// call create collection interface
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">createCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">config</span><span style="color:#ce5c00;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">ok</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;============== Create collection success. ================&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">;</span>
        <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Create collection failed.&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">toString</span><span style="color:#ce5c00;font-weight:bold">());</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>
    <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaBEException</span> <span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><h3 id="42-查询集合配置信息">4.2. 查询集合配置信息</h3>
<p><strong>接口：</strong> DescribeCollectionResponse <strong>describeCollection</strong>(String collectionName)</p>
<p><em>根据传入的集合名称，获取当前集合对应的相关配置信息。</em></p>
<p><strong>参数说明</strong>：</p>
<ul>
<li>collectionName：集合名称</li>
</ul>
<p><strong>返回值：</strong></p>
<ul>
<li>DescribeCollectionResponse：其中包含 Status 以及 CollectionInfo 两部分，Status 描述当前请求成功与否，CollectionInfo 描述集合的配置信息</li>
</ul>
<p><strong>示例：</strong></p>
<p>查询 collection 的配置信息</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">describeCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaSearchClient</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#000">String</span> <span style="color:#000">collectionName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#8f5902;font-style:italic">// describe collection
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">DescribeCollectionResponse</span> <span style="color:#000">descResponse</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">describeCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">collectionName</span><span style="color:#ce5c00;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">descResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">ok</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;================ Describe collection success. ===================&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
        <span style="color:#000">CollectionInfo</span> <span style="color:#000">info</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">descResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCollectionInfo</span><span style="color:#ce5c00;font-weight:bold">();</span>
        <span style="color:#000">CollectionConfig</span> <span style="color:#000">collectionConfig</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">info</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCollectionConfig</span><span style="color:#ce5c00;font-weight:bold">();</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;CollectionName: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">collectionConfig</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCollectionName</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;CollectionStatus: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">info</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCollectionStatus</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Uuid: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">info</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getUuid</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Forward columns: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">collectionConfig</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getForwardColumnNames</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">IndexColumnParam</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">indexColumnParamList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">collectionConfig</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getIndexColumnParams</span><span style="color:#ce5c00;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">indexColumnParamList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">size</span><span style="color:#ce5c00;font-weight:bold">();</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#000">IndexColumnParam</span> <span style="color:#000">indexParam</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">indexColumnParamList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">get</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;IndexColumn: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">indexParam</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumnName</span><span style="color:#ce5c00;font-weight:bold">());</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;IndexType: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">indexParam</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDataType</span><span style="color:#ce5c00;font-weight:bold">());</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;DataType: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">indexParam</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDataType</span><span style="color:#ce5c00;font-weight:bold">());</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Dimension: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">indexParam</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDimension</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Describe collection failed &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">descResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">toString</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><h3 id="43-查询集合统计信息">4.3. 查询集合统计信息</h3>
<p><strong>接口：</strong> StatsCollectionResponse <strong>statsCollection</strong>(String collectionName)</p>
<p><em>根据传入的集合名称，获取当前集合对应的相关统计信息。</em></p>
<p><strong>参数说明</strong>：</p>
<ul>
<li>collectionName：集合名称</li>
</ul>
<p><strong>返回值：</strong></p>
<ul>
<li>StatsCollectionResponse：其中包含 Status 以及 CollectionStats 两部分，Status 描述当前请求成功与否，CollectionStats 描述集合的相关统计信息，包含的信息如下：</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">字段名称</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">collectionPath</td>
<td style="text-align:left">collection 的索引路径</td>
</tr>
<tr>
<td style="text-align:left">totalDocCount</td>
<td style="text-align:left">总的文档数量</td>
</tr>
<tr>
<td style="text-align:left">totalSegmentCount</td>
<td style="text-align:left">总的segment数量</td>
</tr>
<tr>
<td style="text-align:left">totalIndexFileCount</td>
<td style="text-align:left">总的索引文件数量</td>
</tr>
<tr>
<td style="text-align:left">totalIndexFileSize</td>
<td style="text-align:left">总的索引文件大小</td>
</tr>
<tr>
<td style="text-align:left">segmentStatsList</td>
<td style="text-align:left">每个 segment 相应的统计信息，包括 segment 的总文档数量、索<br>引文件数量和大小，以及最大/小 doc id等</td>
</tr>
</tbody>
</table>
<p><strong>示例 ：</strong></p>
<p>查询指定集合的统计信息</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">statsCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaSearchClient</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#000">String</span> <span style="color:#000">collectionName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#8f5902;font-style:italic">// call stats collection interface
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">StatsCollectionResponse</span> <span style="color:#000">statsResponse</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">statsCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">collectionName</span><span style="color:#ce5c00;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">statsResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">ok</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;==================== Stats collection success. ======================&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
        <span style="color:#000">CollectionStats</span> <span style="color:#000">stats</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">statsResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCollectionStats</span><span style="color:#ce5c00;font-weight:bold">();</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;CollectionName: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">stats</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCollectionName</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TotalDocCount: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">stats</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getTotalDocCount</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;TotalSegmentCount: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">stats</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getTotalSegmentCount</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">stats</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getSegmentStatsCount</span><span style="color:#ce5c00;font-weight:bold">();</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Segment: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SegmentDocCount: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">stats</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getSegmentStats</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">).</span><span style="color:#c4a000">getDocDount</span><span style="color:#ce5c00;font-weight:bold">());</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SegmentIndexFileCount: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">stats</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getSegmentStats</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">).</span><span style="color:#c4a000">getIndexFileCount</span><span style="color:#ce5c00;font-weight:bold">());</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;SegmentMaxDocId: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">stats</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getSegmentStats</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">).</span><span style="color:#c4a000">getMaxDocId</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Stats collection failed &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">statsResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getStatus</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">toString</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><h3 id="44-删除集合">4.4. 删除集合</h3>
<p><strong>接口：</strong> Status <strong>dropCollection</strong>(String collectionName)</p>
<p><em>删除指定集合，集合名由参数 collectionName 指定</em></p>
<p><strong>参数说明</strong>：</p>
<ul>
<li>collectionName：删除的集合名称</li>
</ul>
<p><strong>返回值</strong>：</p>
<ul>
<li>Status：表示删除成功与否，其中包含错误码和错误描述</li>
</ul>
<p><strong>示例</strong> ：</p>
<p>删除指定集合</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">dropCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaSearchClient</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#000">String</span> <span style="color:#000">collectionName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#8f5902;font-style:italic">// call drop collection interface
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">dropCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">collectionName</span><span style="color:#ce5c00;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">ok</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;==================== Dorp collection success. ========================&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Drop collection failed &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">toString</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><h3 id="45-获取集合列表">4.5. 获取集合列表</h3>
<p><strong>接口：</strong> ListCollectionsResponse <strong>listCollections</strong>(ListCondition listCondition)</p>
<p><em>根据传入的 ListCondition 条件获取满足条件的集合列表</em></p>
<p><strong>参数说明</strong>：</p>
<ul>
<li>listCondition：集合需要满足的条件，目前只包含了一个 Repository 名称字段，仅用在Mysql 同步数据时，如果该字段为空或者 listCondition 为空时，返回所有的集合</li>
</ul>
<p><strong>返回值</strong>：</p>
<ul>
<li>ListCollectionsResponse：包含 Status 和 CollectionInfo List 两部分，前者描述请求是否成功，后者描述所有集合的配置信息。</li>
</ul>
<p><em><strong>示例 ：</strong></em></p>
<p>获取 repository name 为 mysql_repo 的所有集合</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">listCollections</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaSearchClient</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#8f5902;font-style:italic">// build list condition object
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">ListCondition</span> <span style="color:#000">listCondition</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ListCondition</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withRepositoryName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;mysql_repo&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>  <span style="color:#8f5902;font-style:italic">// set repository name
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>

    <span style="color:#8f5902;font-style:italic">// call list collections interface
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">ListCollectionsResponse</span> <span style="color:#000">listResponse</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">listCollections</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">listCondition</span><span style="color:#ce5c00;font-weight:bold">);</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">listResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">ok</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;List collections success.&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">listResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCollectionCount</span><span style="color:#ce5c00;font-weight:bold">();</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Collection &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
            <span style="color:#000">CollectionInfo</span> <span style="color:#000">info</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">listResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCollection</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
            <span style="color:#000">CollectionConfig</span> <span style="color:#000">collectionConfig</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">info</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCollectionConfig</span><span style="color:#ce5c00;font-weight:bold">();</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;CollectionName: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">collectionConfig</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCollectionName</span><span style="color:#ce5c00;font-weight:bold">());</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;CollectionStatus: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">info</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCollectionStatus</span><span style="color:#ce5c00;font-weight:bold">());</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Uuid: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">info</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getUuid</span><span style="color:#ce5c00;font-weight:bold">());</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Forward columns: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">collectionConfig</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getForwardColumnNames</span><span style="color:#ce5c00;font-weight:bold">());</span>
            <span style="color:#000">List</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">IndexColumnParam</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">indexColumnParamList</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">collectionConfig</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getIndexColumnParams</span><span style="color:#ce5c00;font-weight:bold">();</span>
            <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">indexColumnParamList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">size</span><span style="color:#ce5c00;font-weight:bold">();</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
                <span style="color:#000">IndexColumnParam</span> <span style="color:#000">indexParam</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">indexColumnParamList</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">get</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">);</span>
                <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;IndexColumn: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">indexParam</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getColumnName</span><span style="color:#ce5c00;font-weight:bold">());</span>
                <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;IndexType: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">indexParam</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDataType</span><span style="color:#ce5c00;font-weight:bold">());</span>
                <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;DataType: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">indexParam</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDataType</span><span style="color:#ce5c00;font-weight:bold">());</span>
                <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Dimension: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">indexParam</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDimension</span><span style="color:#ce5c00;font-weight:bold">());</span>
            <span style="color:#ce5c00;font-weight:bold">}</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;List collections failed &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">listResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">toString</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><h2 id="5-文档管理">5. 文档管理</h2>
<p>文档管理主要包括文档的插入、更新和删除操作，ProximaBE 中将文档的这三种操作，整合为一个通用的 Write 接口，通过一个 WriteRequest 结构来描述相关的操作，WriteRequest 中既可以描述单条记录的操作，也可以描述批量记录的操作。</p>
<h3 id="51-创建-writerequest">5.1. 创建 WriteRequest</h3>
<p><strong>构造类：WriteRequest.Builder</strong></p>
<p><em>首先通过 WriteRequest 的 newBuilder() 接口创建出 WriteRequest 的 Builder 对象，然后通过 Builder 对象设置相关参数，包括集合名称、正排列和索引列，以及 Rows等信息，最终调用 Builder 的 build 接口创建出 WriteRequest 对象。</em></p>
<p><strong>参数说明</strong>：</p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">collectionName</td>
<td style="text-align:left">集合名称，String类型</td>
</tr>
<tr>
<td style="text-align:left">forwardColumnList</td>
<td style="text-align:left">正排列的名称列表，List类型，插入和更新时必须要设置，删除时不需要设置</td>
</tr>
<tr>
<td style="text-align:left">indexColumnMetaList</td>
<td style="text-align:left">索引列的 Meta 列表，插入和更新时必须要设置，删除时不需要设置</td>
</tr>
<tr>
<td style="text-align:left">rows</td>
<td style="text-align:left">请求中包含的文档操作列表，List类型，每一个 row 表示一个文档操作，具体内容见 Rows 参数说明</td>
</tr>
<tr>
<td style="text-align:left">requestId</td>
<td style="text-align:left">请求的 id，String类型，默认为空</td>
</tr>
<tr>
<td style="text-align:left">magicNumber</td>
<td style="text-align:left">请求中的魔数，long类型，仅在通过 Mysql 作为数据源时需要设置</td>
</tr>
</tbody>
</table>
<p><strong>Row 参数说明</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">primaryKey</td>
<td style="text-align:left">row的主键，long类型</td>
</tr>
<tr>
<td style="text-align:left">operationType</td>
<td style="text-align:left">row的操作类型，候选值为 INSERT、UPDATE、DELETE三种</td>
</tr>
<tr>
<td style="text-align:left">indexValues</td>
<td style="text-align:left">对应索引列的值列表，List类型，operationType为DELETE操作时，不需要指定，支持三种格式：<br> <ul><li>向量数组，如[1.0, 2.0, 3.0]</li><li>json数组str，如&quot;[1.0,2.0,3.0]&quot;</li><li>bytes，必须为小端字节序。</li></ul></td>
</tr>
<tr>
<td style="text-align:left">forwardValues</td>
<td style="text-align:left">对应正排列的值列表，List类型，operationType为DELETE时，不需要指定</td>
</tr>
<tr>
<td style="text-align:left">lsnContext</td>
<td style="text-align:left">mysql 的 lsn 信息，仅当用 mysql 做数据同步时需要</td>
</tr>
</tbody>
</table>
<h3 id="52-执行写入">5.2. 执行写入</h3>
<p><strong>接口：</strong> Status <strong>write</strong>(WriteRequest request)</p>
<p><em>向 ProximaBE 中写入文档操作请求，执行完成后返回 Status，表示执行成功与否，如果传入的 WriteRequest 请求非法，会抛出 ProximaBEException 异常。</em></p>
<p><strong>参数说明：</strong></p>
<ul>
<li>request：包含某个集合的插入、更新和删除等文档操作</li>
</ul>
<p><em><strong>返回值：</strong></em></p>
<ul>
<li>Status：表示写入请求的成功与否</li>
</ul>
<h3 id="53-示例">5.3. 示例</h3>
<p><strong>示例1</strong>：向集合 collection1 中分别插入和更新一条记录</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">write1</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaSearchClient</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#000">String</span> <span style="color:#000">collectionName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">float</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">vectors1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">3</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">4</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">5</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">6</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">7</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">8</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">};</span>
    <span style="color:#204a87;font-weight:bold">float</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">vectors2</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">5f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">5f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">3</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">5f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">4</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">5f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">5</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">5f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">6</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">5f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">7</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">5f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">8</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">5f</span><span style="color:#ce5c00;font-weight:bold">};</span>
    <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">dimension</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">8</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">long</span> <span style="color:#000">primaryKey</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">123456</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">forward1Value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">123</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">float</span> <span style="color:#000">forward2Value</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">100</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">123f</span><span style="color:#ce5c00;font-weight:bold">;</span>

    <span style="color:#8f5902;font-style:italic">// build insert row
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Row</span> <span style="color:#000">insertRow</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withPrimaryKey</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">primaryKey</span><span style="color:#ce5c00;font-weight:bold">)</span>                           <span style="color:#8f5902;font-style:italic">// set primary key
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withOperationType</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">OperationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">INSERT</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic">// set operation type
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addIndexValue</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">vectors1</span><span style="color:#ce5c00;font-weight:bold">)</span>                        <span style="color:#8f5902;font-style:italic">// add one index value
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addForwardValue</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">forward1Value</span><span style="color:#ce5c00;font-weight:bold">)</span>                 <span style="color:#8f5902;font-style:italic">// add one forard value
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addForwardValue</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">forward2Value</span><span style="color:#ce5c00;font-weight:bold">)</span>                 <span style="color:#8f5902;font-style:italic">// add one forward value
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>

    <span style="color:#8f5902;font-style:italic">// build update row
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Row</span> <span style="color:#000">updateRow</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withPrimaryKey</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">primaryKey</span><span style="color:#ce5c00;font-weight:bold">)</span>                           <span style="color:#8f5902;font-style:italic">// set primary key
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withOperationType</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">OperationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">UPDATE</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic">// set operation type
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addIndexValue</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">vectors2</span><span style="color:#ce5c00;font-weight:bold">)</span>                        <span style="color:#8f5902;font-style:italic">// add index value
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addForwardValue</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">forward1Value</span><span style="color:#ce5c00;font-weight:bold">)</span>                 <span style="color:#8f5902;font-style:italic">// add forward value
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addForwardValue</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">forward2Value</span><span style="color:#ce5c00;font-weight:bold">)</span>                 <span style="color:#8f5902;font-style:italic">// add forward value
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>

    <span style="color:#8f5902;font-style:italic">// build delete row
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">long</span> <span style="color:#000">deleteKey</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">10000</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Row</span> <span style="color:#000">deleteRow</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withPrimaryKey</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">deleteKey</span><span style="color:#ce5c00;font-weight:bold">)</span>                            <span style="color:#8f5902;font-style:italic">// set primary key
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withOperationType</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">OperationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">DELETE</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic">// set operation type
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>

    <span style="color:#8f5902;font-style:italic">// build write request
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">WriteRequest</span> <span style="color:#000">writeRequest</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withCollectionName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">collectionName</span><span style="color:#ce5c00;font-weight:bold">)</span>                            <span style="color:#8f5902;font-style:italic">// set collection name
</span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withForwardColumnList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">Arrays</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">asList</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;forward1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;forward2&#34;</span><span style="color:#ce5c00;font-weight:bold">))</span>  <span style="color:#8f5902;font-style:italic">// set forward column list
</span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addIndexColumnMeta</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;index1&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">DataType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">VECTOR_FP32</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">dimension</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic">// add one index column meta, otherwise call withIndexColumnMetaList
</span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addRow</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">insertRow</span><span style="color:#ce5c00;font-weight:bold">)</span>                                             <span style="color:#8f5902;font-style:italic">// add insert row
</span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addRow</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">updateRow</span><span style="color:#ce5c00;font-weight:bold">)</span>                                             <span style="color:#8f5902;font-style:italic">// add update row
</span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addRow</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">deleteRow</span><span style="color:#ce5c00;font-weight:bold">)</span>                                             <span style="color:#8f5902;font-style:italic">// add delete row
</span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>

    <span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#8f5902;font-style:italic">// call write interface
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">write</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">writeRequest</span><span style="color:#ce5c00;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">ok</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;============== Write success. ===============&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">;</span>
        <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Write failed &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">toString</span><span style="color:#ce5c00;font-weight:bold">());</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>
    <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaBEException</span> <span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}*/</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><p><strong>示例2</strong>：向集合 collection1 中删除一条记录</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">write2</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaSearchClient</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#000">String</span> <span style="color:#000">collectionName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#8f5902;font-style:italic">// build delete row
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">long</span> <span style="color:#000">deleteKey</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">123456</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Row</span> <span style="color:#000">deleteRow</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">Row</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withPrimaryKey</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">deleteKey</span><span style="color:#ce5c00;font-weight:bold">)</span>                            <span style="color:#8f5902;font-style:italic">// set primary key
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withOperationType</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">OperationType</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">DELETE</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic">// set operation type
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>

    <span style="color:#8f5902;font-style:italic">// build write request
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">WriteRequest</span> <span style="color:#000">writeRequest</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">WriteRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withCollectionName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">collectionName</span><span style="color:#ce5c00;font-weight:bold">)</span>                            <span style="color:#8f5902;font-style:italic">// set collection name
</span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addRow</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">deleteRow</span><span style="color:#ce5c00;font-weight:bold">)</span>                                             <span style="color:#8f5902;font-style:italic">// add delete row
</span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>

    <span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#8f5902;font-style:italic">// call write interface
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">Status</span> <span style="color:#000">status</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">write</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">writeRequest</span><span style="color:#ce5c00;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">ok</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;============== Write success. ===============&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">;</span>
        <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Write failed &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">status</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">toString</span><span style="color:#ce5c00;font-weight:bold">());</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>
    <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaBEException</span> <span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}*/</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><h2 id="6-文档查询">6. 文档查询</h2>
<p>文档查询目前主要包括两种类型，一种是根据向量来进行 knn 的查询，另一种是直接根据文档的主键来查询相应的文档。</p>
<h3 id="61-向量查询">6.1. 向量查询</h3>
<h4 id="611-创建-queryrequest">6.1.1 创建 QueryRequest</h4>
<p><strong>构造类：QueryRequest.Builder</strong></p>
<p><em>通过 QueryRequest 的 newBuilder 接口创建出 QueryRequest 的 Builder 对象，然后通过 Builder 对象设置相关查询参数，主要包括集合名称和 KnnQueryParam等参数，最终调用 Builder 的 build 接口构建出 QueryRequest 对象。</em></p>
<p><strong>参数说明：</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">collectionName</td>
<td style="text-align:left">要查询的集合名称，String类型</td>
</tr>
<tr>
<td style="text-align:left">knnQueryParam</td>
<td style="text-align:left">knn 查询的参数，KnnQueryParam类型，具体内容见下表</td>
</tr>
<tr>
<td style="text-align:left">debugMode</td>
<td style="text-align:left">是否开启调试模式，boolean类型，默认为false</td>
</tr>
</tbody>
</table>
<p><strong>KnnQueryParam 参数</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">columnName</td>
<td style="text-align:left">要查询的索引列名，String类型</td>
</tr>
<tr>
<td style="text-align:left">topk</td>
<td style="text-align:left">查询的结果数量，int类型，默认为100</td>
</tr>
<tr>
<td style="text-align:left">features</td>
<td style="text-align:left">查询的特征，可以是单个或者多个向量，支持三种类型：<br /> <ul><li>小端字节序的bytes</li><li>json数组字符串，支持嵌套json数组。如2个batch的2维向量，可以写为&quot;[[1.0,2.0],[3.0,4.0]]&quot;</li><li>向量列表，如[[5.1, 3.5, 1.4, 0.2], [5.5, 2.3, 4.0, 1.3]]</li></ul></td>
</tr>
<tr>
<td style="text-align:left">dataType</td>
<td style="text-align:left">查询向量的数据类型，向量列表类型的特征支持自动推导，其它类型的必须设置</td>
</tr>
<tr>
<td style="text-align:left">dimension</td>
<td style="text-align:left">查询向量的维度，向量列表类型的特征支持自动推导，其它类型的必须设置</td>
</tr>
<tr>
<td style="text-align:left">batchCount</td>
<td style="text-align:left">查询的batch数量，向量列表类型的特征支持自动推导，其它类型的必须设置</td>
</tr>
<tr>
<td style="text-align:left">radius</td>
<td style="text-align:left">过滤结果的分数阈值，仅当分数小于该阈值的结果会返回，float类型，默认值为0，表示不过滤</td>
</tr>
<tr>
<td style="text-align:left">isLinear</td>
<td style="text-align:left">是否使用暴力检索，boolean类型，默认false</td>
</tr>
</tbody>
</table>
<h4 id="612-执行查询">6.1.2 执行查询</h4>
<p><strong>接口：</strong> QueryResponse <strong>query</strong>(QueryRequest request)</p>
<p><em>通过调用上述接口，向 ProximaBE 发起查询请求，返回 QueryResponse，当传入的 QueryRequest 非法时，会抛出 ProximaBEException 异常。</em></p>
<p><strong>参数说明：</strong></p>
<ul>
<li>request：表示查询请求，包含查询的集合以及查询的向量等信息</li>
</ul>
<p><strong>返回值：</strong></p>
<ul>
<li>QueryResponse：表示查询的返回结果，包含查询的状态信息，以及查询的文档结果。</li>
</ul>
<h4 id="613-示例">6.1.3. 示例</h4>
<p>根据某个向量查询最相似的文档</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">query</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaSearchClient</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#000">String</span> <span style="color:#000">collectionName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">float</span><span style="color:#ce5c00;font-weight:bold">[]</span> <span style="color:#000">features</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">1</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">2</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">3</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">4</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">5</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">6</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">7</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#000">8</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">0f</span><span style="color:#ce5c00;font-weight:bold">};</span>
    <span style="color:#8f5902;font-style:italic">//  when batch querying, features can be following:
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">//  float[][] features = {
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">//          {1.0f, 2.0f, 3.0f, 4.0f, 5.0f, 6.0f, 7.0f, 8.0f},
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">//          {1.0f, 2.0f, 3.0f, 4.0f, 5.0f, 6.0f, 7.0f, 8.0f}
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#8f5902;font-style:italic">//  };
</span><span style="color:#8f5902;font-style:italic"></span>
    <span style="color:#8f5902;font-style:italic">// build query request
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">QueryRequest</span> <span style="color:#000">queryRequest</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">QueryRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withCollectionName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">collectionName</span><span style="color:#ce5c00;font-weight:bold">)</span>              <span style="color:#8f5902;font-style:italic">// set collection name
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withKnnQueryParam</span><span style="color:#ce5c00;font-weight:bold">(</span>                              <span style="color:#8f5902;font-style:italic">// set knn query param
</span><span style="color:#8f5902;font-style:italic"></span>                    <span style="color:#000">QueryRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">KnnQueryParam</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>  <span style="color:#8f5902;font-style:italic">// new KnnQueryParam builder
</span><span style="color:#8f5902;font-style:italic"></span>                            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withColumnName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;index1&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>        <span style="color:#8f5902;font-style:italic">// set index column name
</span><span style="color:#8f5902;font-style:italic"></span>                            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withTopk</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">10</span><span style="color:#ce5c00;font-weight:bold">)</span>                    <span style="color:#8f5902;font-style:italic">// set topk
</span><span style="color:#8f5902;font-style:italic"></span>                            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withFeatures</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">features</span><span style="color:#ce5c00;font-weight:bold">)</span>          <span style="color:#8f5902;font-style:italic">// set query features
</span><span style="color:#8f5902;font-style:italic"></span>                            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">())</span>                        <span style="color:#8f5902;font-style:italic">// build knnQueryParam object
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>                                        <span style="color:#8f5902;font-style:italic">// build query request
</span><span style="color:#8f5902;font-style:italic"></span>
    <span style="color:#000">QueryResponse</span> <span style="color:#000">queryResponse</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#8f5902;font-style:italic">// call query interface
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">queryResponse</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">query</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">queryRequest</span><span style="color:#ce5c00;font-weight:bold">);</span>
    <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaBEException</span> <span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">queryResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">ok</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;================ Query success =====================&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">queryResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getQueryResultCount</span><span style="color:#ce5c00;font-weight:bold">();</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#000">QueryResult</span> <span style="color:#000">queryResult</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">queryResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getQueryResult</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">);</span>
            <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">d</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">0</span><span style="color:#ce5c00;font-weight:bold">;</span> <span style="color:#000">d</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">queryResult</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDocumentCount</span><span style="color:#ce5c00;font-weight:bold">();</span> <span style="color:#ce5c00;font-weight:bold">++</span><span style="color:#000">d</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
                <span style="color:#000">Document</span> <span style="color:#000">document</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">queryResult</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDocument</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">d</span><span style="color:#ce5c00;font-weight:bold">);</span>
                <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Doc key: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">document</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getPrimaryKey</span><span style="color:#ce5c00;font-weight:bold">());</span>
                <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Doc score: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">document</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getScore</span><span style="color:#ce5c00;font-weight:bold">());</span>

                <span style="color:#000">Set</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">forwardKeys</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">document</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getForwardKeySet</span><span style="color:#ce5c00;font-weight:bold">();</span>
                <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span> <span style="color:#000">forwardKey</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">forwardKeys</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
                    <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Doc forward: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">forwardKey</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34; -&gt; &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span>
                                                          <span style="color:#000">document</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getForwardValue</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">forwardKey</span><span style="color:#ce5c00;font-weight:bold">).</span><span style="color:#c4a000">getStringValue</span><span style="color:#ce5c00;font-weight:bold">());</span>
                <span style="color:#ce5c00;font-weight:bold">}</span>
            <span style="color:#ce5c00;font-weight:bold">}</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Query failed: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">queryResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getStatus</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">toString</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><h3 id="62-主键查询">6.2. 主键查询</h3>
<h4 id="621-创建-getdocumentrequest">6.2.1 创建 GetDocumentRequest</h4>
<p><strong>构造类：GetDocumentRequest.Builder</strong></p>
<p><em>通过 GetDocumentRequest 的 newBuilder 接口，创建出 GetDocumentRequest 的 Builder 对象，然后通过 Builder 对象设置相关查询参数，主要包括集合名称和 主键等参数，最终调用 Builder 的 build 接口构建出 GetDocumentRequest 对象。</em></p>
<p><strong>Builder 参数说明：</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">参数</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">collectionName</td>
<td style="text-align:left">要查询的集合名称，String类型</td>
</tr>
<tr>
<td style="text-align:left">primaryKey</td>
<td style="text-align:left">要查询的文档的主键，long类型</td>
</tr>
<tr>
<td style="text-align:left">debugMode</td>
<td style="text-align:left">是否开启调试模式， boolean类型，默认为false</td>
</tr>
</tbody>
</table>
<h4 id="622-执行查询">6.2.2 执行查询</h4>
<p><strong>接口：</strong> GetDocumentResponse <strong>getDocumentByKey</strong>(GetDocumentRequest request)</p>
<p><em>通过调用上述接口，向 ProximaBE 发起查询请求，返回 GetDocumentResponse 对象，当传入的 GetDocumentRequest 非法时，会抛出 ProximaBEException 异常。</em></p>
<p><strong>参数说明</strong>：</p>
<ul>
<li>request：表示查询指定文档请求</li>
</ul>
<p><strong>返回值</strong>：</p>
<ul>
<li>GetDocumentResponse：表示查询的返回结果，包含查询的状态信息，以及查询文档的结果。</li>
</ul>
<h4 id="623-示例">6.2.3 示例</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#204a87;font-weight:bold">public</span> <span style="color:#204a87;font-weight:bold">boolean</span> <span style="color:#000">getDocument</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaSearchClient</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#000">String</span> <span style="color:#000">collectionName</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;collection1&#34;</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#8f5902;font-style:italic">// build get document request
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">GetDocumentRequest</span> <span style="color:#000">getRequest</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GetDocumentRequest</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">newBuilder</span><span style="color:#ce5c00;font-weight:bold">()</span>
            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withCollectionName</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">collectionName</span><span style="color:#ce5c00;font-weight:bold">)</span>    <span style="color:#8f5902;font-style:italic">// set collection name
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withPrimaryKey</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">123456</span><span style="color:#ce5c00;font-weight:bold">)</span>                <span style="color:#8f5902;font-style:italic">// set primary key
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">withDebugMode</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">)</span>                   <span style="color:#8f5902;font-style:italic">// set debug mode, defalut false
</span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">build</span><span style="color:#ce5c00;font-weight:bold">();</span>                              <span style="color:#8f5902;font-style:italic">// build GetDocumentRequest object
</span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">GetDocumentResponse</span> <span style="color:#000">getResponse</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#204a87;font-weight:bold">try</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#8f5902;font-style:italic">// call get document by key interface
</span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">getResponse</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDocumentByKey</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">getRequest</span><span style="color:#ce5c00;font-weight:bold">);</span>
    <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">ProximaBEException</span> <span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">e</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">printStackTrace</span><span style="color:#ce5c00;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span>
    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">getResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">ok</span><span style="color:#ce5c00;font-weight:bold">())</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;======================== Get Document success ======================== &#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
        <span style="color:#000">Document</span> <span style="color:#000">document</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">getResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDocument</span><span style="color:#ce5c00;font-weight:bold">();</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;PrimaryKey: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">document</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getPrimaryKey</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Score: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">document</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getScore</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#000">Set</span><span style="color:#ce5c00;font-weight:bold">&lt;</span><span style="color:#000">String</span><span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">forwardKeys</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">document</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getForwardKeySet</span><span style="color:#ce5c00;font-weight:bold">();</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">String</span> <span style="color:#000">forwardKey</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#000">forwardKeys</span><span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">{</span>
            <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Doc forward: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">forwardKey</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34; -&gt; &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span>
                   <span style="color:#000">document</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getForwardValue</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">forwardKey</span><span style="color:#ce5c00;font-weight:bold">).</span><span style="color:#c4a000">getStringValue</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#ce5c00;font-weight:bold">}</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;DebugInfo: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">getResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getDebugInfo</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#ce5c00;font-weight:bold">{</span>
        <span style="color:#000">System</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">out</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">println</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Get document failed &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">getResponse</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getStatus</span><span style="color:#ce5c00;font-weight:bold">().</span><span style="color:#c4a000">toString</span><span style="color:#ce5c00;font-weight:bold">());</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">false</span><span style="color:#ce5c00;font-weight:bold">;</span>
    <span style="color:#ce5c00;font-weight:bold">}</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3b5fc766df1bef33968337e2ac3f60d9">4 - Golang SDK</h1>
    
	<p>用户可以使用Golang SDK进行集合管理、文档的增删该查等功能</p>
<h2 id="1-be客户端创建">1. BE客户端创建</h2>
<p>ProximaSearchClient 是BE的客户端接口对象，用户通过该实例对象与BE进行交互，完成的管控功能</p>
<h3 id="11-创建客户端">1.1. 创建客户端</h3>
<p><strong><u>NewProximaSearchClient(ConnectionProtocol, *Address) (ProximaSearchClient, error)</u></strong></p>
<p><em>创建BE客户端，创建成功后返回ProximaSearchClient对象, 否则返回error。</em></p>
<p><strong>参数说明：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>ConnectionProtocol: </font></strong> <em><font color=#2f3f4f>与BE交互的协议类型，目前支持GRPC、HTTP两种协议，其中GRPC在性能以及资源占用上有明显的优势。</font></em></li>
<li><strong><font color=#2f3f4f>*Address：</font></strong> <em><font color=#2f3f4f>该参数指定BE的网络连接信息，主要包含BE的域名，以及端口号,详细定义如下：</font></em></li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#8f5902;font-style:italic">// Address reference to entrypoint of ProximaBE
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">Address</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#8f5902;font-style:italic">// Host IP address or host name
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">Host</span> <span style="color:#204a87;font-weight:bold">string</span> <span style="color:#4e9a06">`json:&#34;host:omitempty&#34;`</span>
	<span style="color:#8f5902;font-style:italic">// Port
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">Port</span> <span style="color:#204a87;font-weight:bold">uint32</span> <span style="color:#4e9a06">`json:&#34;port&#34;`</span>
<span style="color:#000;font-weight:bold">}</span>

</code></pre></div><p><strong>返回值：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>ProximaSearchClient: </font></strong> <em><font color=#2f3f4f>BE客户端对象</font></em></li>
<li><strong><font color=#2f3f4f>error: </font></strong> <em><font color=#2f3f4f>执行错误时返回非nil</font></em></li>
</ul>
<p><strong><font color=#3f4f5f>特殊说明：</font></strong></p>
<ul>
<li><font color=#3f4f5f size=2>SDK中已封装了与BE通信的协议类型，如想进一步了解协议内容，请参考<a href="/docs/apireference/http/">Restful API</a>章节</font></li>
</ul>
<p><em><strong>示例：</strong></em> <u>创建BE客户端</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#204a87;font-weight:bold">package</span> <span style="color:#000">main</span>

<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">(</span>
	<span style="color:#4e9a06">&#34;log&#34;</span>
	<span style="color:#4e9a06">&#34;proxima-be-sdk-go/proxima/se/sdk&#34;</span>
<span style="color:#000;font-weight:bold">)</span>

<span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#8f5902;font-style:italic">// Create client of BE with GRPC protocol and connect to localhost:16000
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">client</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">NewProximaSearchClient</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">GrpcProtocol</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Address</span><span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">Host</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;localhost&#34;</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#000">Port</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">16000</span><span style="color:#000;font-weight:bold">,</span>
	<span style="color:#000;font-weight:bold">})</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Can&#39;t create ProximaClient instance.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h2 id="2-集合管理">2. 集合管理</h2>
<h3 id="21-集合创建">2.1. 集合创建</h3>
<p><strong><u>CreateCollection(config *CollectionConfig) error</u></strong></p>
<p><em>根据参数创建集合，创建成功后返回nil, 否则返回error。</em></p>
<p><strong>参数说明：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>config: </font></strong> <em><font color=#2f3f4f><u>CollectionConfig</u>中指定了集合的配置信息，包含不仅限于集合名、分片配置、正排列名、索引列信息等，当BE作为Mysql的从属库时，需指定Mysql Repo的相关配置，详情如示例。</font></em></li>
</ul>
<p><strong>返回值：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>error: </font></strong> <em><font color=#2f3f4f>正常执行返回nil, 否则返回有效error对象</font></em></li>
</ul>
<p><em><strong>示例 1.1：</strong></em> <u>创建一个带有两个正排列，以及两个向量索引列的集合</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">fun</span> <span style="color:#000">createCollctionDemo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ProximaSearchClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#8f5902;font-style:italic">// Create collection with no attached repository
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">config</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CollectionConfig</span><span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">CollectionName</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#4e9a06">&#34;example&#34;</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#000">MaxDocsPerSegment</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// 0 means unlimited, which is equal max value of system
</span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">ForwardColumns</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;forward&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;forward1&#34;</span><span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000">Columns</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ColumnIndex</span><span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000;font-weight:bold">{</span>
				<span style="color:#000">Name</span><span style="color:#000;font-weight:bold">:</span>        <span style="color:#4e9a06">&#34;column&#34;</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">IndexType</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>                                     <span style="color:#8f5902;font-style:italic">// 0 means default index, which is sdk.ProximaGraphIndex
</span><span style="color:#8f5902;font-style:italic"></span>				<span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>                                     <span style="color:#8f5902;font-style:italic">// 0 means default, which is sdk.VectorFP32
</span><span style="color:#8f5902;font-style:italic"></span>				<span style="color:#000">Dimension</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">,</span>                                     <span style="color:#8f5902;font-style:italic">// Required field, no default value, 0 is not legal argument
</span><span style="color:#8f5902;font-style:italic"></span>				<span style="color:#000">ExtraParams</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;ef_search&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;200&#34;</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#8f5902;font-style:italic">// Advanced params
</span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
				<span style="color:#000">Name</span><span style="color:#000;font-weight:bold">:</span>        <span style="color:#4e9a06">&#34;column1&#34;</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">IndexType</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ProximaGraphIndex</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">VectorFP16</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// Index type is fp16, query could be fp32 for lack of language types
</span><span style="color:#8f5902;font-style:italic"></span>				<span style="color:#000">Dimension</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#0000cf;font-weight:bold">128</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">ExtraParams</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">{},</span>
			<span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000">Repository</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// No repository attached
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CreateCollection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">config</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Can&#39;t create collection.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Create collection succeed.&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><em><strong>示例 1.2：</strong></em> <u>创建一个带有两个正排列、单个向量索引列、以及Mysql Repo的集合</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">fun</span> <span style="color:#000">createCollctionWithRepoDemo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ProximaSearchClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#8f5902;font-style:italic">// Create collection with attached repository
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">config</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CollectionConfig</span><span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">CollectionName</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#4e9a06">&#34;example_with_repo&#34;</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#000">MaxDocsPerSegment</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// 0 means unlimited, which is equal max value of system
</span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">ForwardColumns</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;forward&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;forward1&#34;</span><span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000">Columns</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ColumnIndex</span><span style="color:#000;font-weight:bold">{{</span>
			<span style="color:#000">Name</span><span style="color:#000;font-weight:bold">:</span>        <span style="color:#4e9a06">&#34;column1&#34;</span><span style="color:#000;font-weight:bold">,</span>
			<span style="color:#000">IndexType</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>                                     <span style="color:#8f5902;font-style:italic">// 0 means default index, which is sdk.ProximaGraphIndex
</span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">DataType</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>                                     <span style="color:#8f5902;font-style:italic">// 0 means default, which is sdk.VectorFP32
</span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Dimension</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#0000cf;font-weight:bold">512</span><span style="color:#000;font-weight:bold">,</span>                                   <span style="color:#8f5902;font-style:italic">// Required field, no default value, 0 is not legal argument
</span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">ExtraParams</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;ef_search&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;200&#34;</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#8f5902;font-style:italic">// Advanced params
</span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000">Repository</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DatabaseRepository</span><span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000">Repository</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Repository</span><span style="color:#000;font-weight:bold">{</span>
				<span style="color:#000">Name</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;mysql_repo&#34;</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">Type</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Database</span><span style="color:#000;font-weight:bold">,</span>
			<span style="color:#000;font-weight:bold">},</span>
			<span style="color:#000">Connection</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;mysql://host.com:8080/mysql_database&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// JDBC connection uri
</span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">TableName</span><span style="color:#000;font-weight:bold">:</span>  <span style="color:#4e9a06">&#34;table_name&#34;</span><span style="color:#000;font-weight:bold">,</span>                           <span style="color:#8f5902;font-style:italic">// Table name
</span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">User</span><span style="color:#000;font-weight:bold">:</span>       <span style="color:#4e9a06">&#34;root&#34;</span><span style="color:#000;font-weight:bold">,</span>                                 <span style="color:#8f5902;font-style:italic">// User name
</span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000">Password</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#4e9a06">&#34;root&#34;</span><span style="color:#000;font-weight:bold">,</span>                                 <span style="color:#8f5902;font-style:italic">// Password
</span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000;font-weight:bold">},</span>
	<span style="color:#000;font-weight:bold">}</span>

	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CreateCollection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">config</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Can&#39;t create collection.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Create collection with attached mysql repository succeed.&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="22-获取集合配置信息">2.2. 获取集合配置信息</h3>
<p><strong><u>DescribeCollection(name string) (*CollectionInfo, error)</u></strong></p>
<p><em>获取参数name指定的集合配置信息</em></p>
<p><strong>参数说明：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>name: </font></strong> <em><font color=#2f3f4f>string指定集合名称</font></em></li>
</ul>
<p><strong>返回值：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>CollectionInfo: </font></strong> <em><font color=#2f3f4f>指向CollectionInfo的指针，成功返回时该参数非nil, 失败时通过error参数判定失败原因</font></em></li>
<li><strong><font color=#2f3f4f>error: </font></strong> <em><font color=#2f3f4f>失败返回非nil</font></em></li>
</ul>
<p><em><strong>示例 2.1：</strong></em> <u>获取集合配置信息</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">fun</span> <span style="color:#000">describeCollectionDemo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ProximaSearchClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#8f5902;font-style:italic">// Retrieve collection named by &#39;example_with_repo&#39;
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">info</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DescribeCollection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;example_with_repo&#34;</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Lost collection named by &#39;example_with_repo&#39;, which created before.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Collection(With Repository): %+v\n&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">info</span><span style="color:#000;font-weight:bold">)</span>

	<span style="color:#8f5902;font-style:italic">// Delete collection
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DropCollection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;example_with_repo&#34;</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Failed to drop collection,&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Drop collection succeed.&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="23-删除指定集合">2.3. 删除指定集合</h3>
<p><strong><u>DropCollection(name string) error</u></strong></p>
<p><em>删除指定集合，集合名由参数name指定</em></p>
<p><strong>参数说明：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>name: </font></strong> <em><font color=#2f3f4f>string指定集合名称</font></em></li>
</ul>
<p><strong>返回值：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>error: </font></strong> <em><font color=#2f3f4f>失败返回非nil</font></em></li>
</ul>
<p><em><strong>示例 3.1：</strong></em> <u>删除集合</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">fun</span> <span style="color:#000">dropCollectionDemo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ProximaSearchClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">DropCollection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;example_with_repo&#34;</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CreateCollection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">config</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Can&#39;t create collection.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Create collection with attached mysql repository succeed.&#34;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="24-获取集合统计信息">2.4. 获取集合统计信息</h3>
<p><strong><u>StatCollection(string) (*CollectionStat, error)</u></strong></p>
<p><em>获取参数指定的集合统计信息，执行成功返回指向CollectionStat的有效指针，失败返回error</em></p>
<p><strong>参数说明：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>string: </font></strong> <em><font color=#2f3f4f>指定集合名称</font></em></li>
</ul>
<p><strong>返回值：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>*CollectionStat: </font></strong> <em><font color=#2f3f4f>Collection的统计信息</font></em></li>
<li><strong><font color=#2f3f4f>error: </font></strong> <em><font color=#2f3f4f>失败返回非nil</font></em></li>
</ul>
<p><em><strong>示例 4.1：</strong></em> <u>获取集合统计信息</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">fun</span> <span style="color:#000">statCollectionDemo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ProximaSearchClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">stat</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">StatCollection</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;example&#34;</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Stat collection failed.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Collection Stat: %+v&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">stat</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="25-获取集合列表">2.5. 获取集合列表</h3>
<p><strong><u>ListCollections(filters &hellip;ListCollectionFilter) ([]*CollectionInfo, error)</u></strong></p>
<p><em>获取符合条件的集合列表，执行成功返回CollectionInfo的列表，失败返回error</em></p>
<p><strong>参数说明：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>ListCollectionFilter: </font></strong> <em><font color=#2f3f4f>过滤器对象，过滤器可采用生成器自动生成，可选的生成器如下：</font></em>
<strong><font color=#2f3f4f>- ByRepo(repo string)： </font></strong> <em><font color=#2f3f4f>包含指定repo名称的Collection</font></em></li>
</ul>
<p><strong>返回值：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>[]*CollectionInfo: </font></strong> <em><font color=#2f3f4f>CollectionInfo列表</font></em></li>
<li><strong><font color=#2f3f4f>error: </font></strong> <em><font color=#2f3f4f>失败返回非nil</font></em></li>
</ul>
<p><em><strong>示例 5.1：</strong></em> <u>获取集合列表</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">fun</span> <span style="color:#000">listCollectionsDemo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ProximaSearchClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#8f5902;font-style:italic">// List all collections
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">collections</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ListCollections</span><span style="color:#000;font-weight:bold">()</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Can&#39;t retrieve collections from Proxima Server.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Collections (%d): \n&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collections</span><span style="color:#000;font-weight:bold">))</span>
	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">collection</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">collections</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;%+v\n&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">collection</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>

	<span style="color:#8f5902;font-style:italic">// List all collections by Repo
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">collections</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ListCollections</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ByRepo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;repo&#34;</span><span style="color:#000;font-weight:bold">))</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Can&#39;t retrieve collections from Proxima Server.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Collections (%d): \n&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">collections</span><span style="color:#000;font-weight:bold">))</span>
	<span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">collection</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">collections</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;%+v\n&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">collection</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h2 id="3-文档管理">3. 文档管理</h2>
<p>文档管理整合为一个通用接口Write, 通过接口参数描述所需的操作，接口定义如下：</p>
<p><strong><u>Write(*WriteRequest) error</u></strong></p>
<p><em>向BE中批量写入文档操作请求，执行成功后返回nil, 否则返回值error中描述了错误信息</em></p>
<p><strong>参数说明：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>WriteRequest: </font></strong> <em><font color=#2f3f4f>写入请求内容</font></em></li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#8f5902;font-style:italic">// Row record
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">Row</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#8f5902;font-style:italic">// Primary key of row record
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">PrimaryKey</span> <span style="color:#204a87;font-weight:bold">uint64</span>
	<span style="color:#8f5902;font-style:italic">// Operation type
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">OperationType</span>
	<span style="color:#8f5902;font-style:italic">// Index column value list
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">IndexColumnValues</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}</span>
	<span style="color:#8f5902;font-style:italic">// Forward column value list
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">ForwardColumnValues</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}</span>
	<span style="color:#8f5902;font-style:italic">// Log Sequence Number context
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">LsnContext</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#8f5902;font-style:italic">// RowMeta meta for row records
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">RowMeta</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#8f5902;font-style:italic">// Index column name list
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">IndexColumnNames</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span>
	<span style="color:#8f5902;font-style:italic">// Index column name list
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">ForwardColumnNames</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#8f5902;font-style:italic">// WriteRequest object, the parameter of ProximaBEClient.Write method
</span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">WriteRequest</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#8f5902;font-style:italic">// Name of collection
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">CollectionName</span> <span style="color:#204a87;font-weight:bold">string</span>
	<span style="color:#8f5902;font-style:italic">// Meta header
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">Meta</span> <span style="color:#000">RowMeta</span>
	<span style="color:#8f5902;font-style:italic">// Row record list
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">Rows</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#000">Row</span>
	<span style="color:#8f5902;font-style:italic">// Request ID, Optional
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">RequestID</span> <span style="color:#204a87;font-weight:bold">string</span>
	<span style="color:#8f5902;font-style:italic">// Magic number, Optional
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">MagicNumber</span> <span style="color:#204a87;font-weight:bold">uint64</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>Write API中根据传入参数的 Row.OperationType 判定当前数据是插入、删除、更新中的某种操作类型，可选的OperationType列表如下：</p>
<ul>
<li>**Insert: ** 新增文档</li>
<li><strong>Update：</strong> 更新文档</li>
<li><strong>Delete：</strong> 删除文档</li>
</ul>
<p><strong>返回值：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>error: </font></strong> <em><font color=#2f3f4f>失败返回非nil</font></em></li>
</ul>
<h3 id="31-文档插入">3.1. 文档插入</h3>
<p>指定Row.OperationType为OPInsert可完成文档的插入操作</p>
<p><em><strong>示例 1.1：</strong></em> <u>文档插入</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">fun</span> <span style="color:#000">insertDocumentDemo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ProximaSearchClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">rows</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WriteRequest</span><span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">CollectionName</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;example&#34;</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#000">Meta</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">RowMeta</span><span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000">IndexColumnNames</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;column&#34;</span><span style="color:#000;font-weight:bold">},</span>
			<span style="color:#000">ForwardColumnNames</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;forward&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;forward1&#34;</span><span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000">Rows</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Row</span><span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000;font-weight:bold">{</span>
				<span style="color:#000">PrimaryKey</span><span style="color:#000;font-weight:bold">:</span>          <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">OperationType</span><span style="color:#000;font-weight:bold">:</span>       <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Insert</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">ForwardColumnValues</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}{</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">float32</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1.1</span><span style="color:#000;font-weight:bold">)},</span>
				<span style="color:#000">IndexColumnValues</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}{</span> <span style="color:#8f5902;font-style:italic">// Data type should same with index created before
</span><span style="color:#8f5902;font-style:italic"></span>					<span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">float32</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">6.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">7.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8.0</span><span style="color:#000;font-weight:bold">},</span>
				<span style="color:#000;font-weight:bold">},</span>
				<span style="color:#000">LsnContext</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// With empty context
</span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000">RequestID</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// Optional field
</span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">MagicNumber</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>  <span style="color:#8f5902;font-style:italic">// Optional field
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#8f5902;font-style:italic">// Write rows to collection
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">err</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Write</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rows</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Insert data to collection failed.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="32-文档更新">3.2. 文档更新</h3>
<p>指定Row.OperationType为OPUpdate可完成文档的更新操作</p>
<p><em><strong>示例 2.1：</strong></em><u>更新文档</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">fun</span> <span style="color:#000">updateDocumentDemo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ProximaSearchClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">rows</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WriteRequest</span><span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">CollectionName</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;example&#34;</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#000">Meta</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">RowMeta</span><span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000">IndexColumnNames</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;column&#34;</span><span style="color:#000;font-weight:bold">},</span>
			<span style="color:#000">ForwardColumnNames</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;forward&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;forward1&#34;</span><span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000">Rows</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Row</span><span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000;font-weight:bold">{</span>
				<span style="color:#000">PrimaryKey</span><span style="color:#000;font-weight:bold">:</span>          <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">OperationType</span><span style="color:#000;font-weight:bold">:</span>       <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Update</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">ForwardColumnValues</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}{</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">float32</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2.2</span><span style="color:#000;font-weight:bold">)},</span>
				<span style="color:#000">IndexColumnValues</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}{</span> <span style="color:#8f5902;font-style:italic">// Data type should same with index created before
</span><span style="color:#8f5902;font-style:italic"></span>					<span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">float32</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">21.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">22.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">23.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">24.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">25.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">26.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">27.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">28.0</span><span style="color:#000;font-weight:bold">},</span>
				<span style="color:#000;font-weight:bold">},</span>
				<span style="color:#000">LsnContext</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">LsnContext</span><span style="color:#000;font-weight:bold">{</span> <span style="color:#8f5902;font-style:italic">// With valid context
</span><span style="color:#8f5902;font-style:italic"></span>					<span style="color:#000">LSN</span><span style="color:#000;font-weight:bold">:</span>     <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
					<span style="color:#000">Context</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;write context hear&#34;</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000;font-weight:bold">},</span>
			<span style="color:#000;font-weight:bold">}},</span>
		<span style="color:#000">RequestID</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// Optional field
</span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">MagicNumber</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>  <span style="color:#8f5902;font-style:italic">// Optional field
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#8f5902;font-style:italic">// Write rows to collection
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">err</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Write</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rows</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Insert data to collection failed.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="33-文档删除">3.3. 文档删除</h3>
<p>指定Row.OperationType为OPDelete可完成文档的删除操作</p>
<p><em><strong>示例 3.1：</strong></em><u>删除文档</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">fun</span> <span style="color:#000">deleteDocumentDemo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ProximaSearchClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">rows</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WriteRequest</span><span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">CollectionName</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;example&#34;</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#000">Meta</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">RowMeta</span><span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000">IndexColumnNames</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;column&#34;</span><span style="color:#000;font-weight:bold">},</span>
			<span style="color:#000">ForwardColumnNames</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;forward&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;forward1&#34;</span><span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000">Rows</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Row</span><span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000;font-weight:bold">{</span>
				<span style="color:#000">PrimaryKey</span><span style="color:#000;font-weight:bold">:</span>          <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">OperationType</span><span style="color:#000;font-weight:bold">:</span>       <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Delete</span><span style="color:#000;font-weight:bold">,</span>
			<span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000">RequestID</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// Optional field
</span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">MagicNumber</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>  <span style="color:#8f5902;font-style:italic">// Optional field
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#8f5902;font-style:italic">// Write rows to collection
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">err</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Write</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rows</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Insert data to collection failed.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="34-批量文档操作">3.4. 批量文档操作</h3>
<p>请求中包含多行数据，并指定OperationType完成批量文档操作</p>
<p><em><strong>示例 4.1：</strong></em><u>批量文档操作</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">fun</span> <span style="color:#000">batchDocumentOperationDemo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ProximaSearchClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#000">rows</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WriteRequest</span><span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">CollectionName</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;example&#34;</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#000">Meta</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">RowMeta</span><span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000">IndexColumnNames</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;column&#34;</span><span style="color:#000;font-weight:bold">},</span>
			<span style="color:#000">ForwardColumnNames</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#34;forward&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;forward1&#34;</span><span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000">Rows</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Row</span><span style="color:#000;font-weight:bold">{</span>
			<span style="color:#000;font-weight:bold">{</span>
				<span style="color:#000">PrimaryKey</span><span style="color:#000;font-weight:bold">:</span>          <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">OperationType</span><span style="color:#000;font-weight:bold">:</span>       <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Insert</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">ForwardColumnValues</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}{</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">float32</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1.1</span><span style="color:#000;font-weight:bold">)},</span>
				<span style="color:#000">IndexColumnValues</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}{</span> <span style="color:#8f5902;font-style:italic">// Data type should same with index created before
</span><span style="color:#8f5902;font-style:italic"></span>					<span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">float32</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">6.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">7.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8.0</span><span style="color:#000;font-weight:bold">},</span>
				<span style="color:#000;font-weight:bold">},</span>
				<span style="color:#000">LsnContext</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// With empty context
</span><span style="color:#8f5902;font-style:italic"></span>			<span style="color:#000;font-weight:bold">},</span> <span style="color:#000;font-weight:bold">{</span>
				<span style="color:#000">PrimaryKey</span><span style="color:#000;font-weight:bold">:</span>          <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">OperationType</span><span style="color:#000;font-weight:bold">:</span>       <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Insert</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000">ForwardColumnValues</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}{</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">float32</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">2.2</span><span style="color:#000;font-weight:bold">)},</span>
				<span style="color:#000">IndexColumnValues</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}{</span> <span style="color:#8f5902;font-style:italic">// Data type should same with index created before
</span><span style="color:#8f5902;font-style:italic"></span>					<span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">float32</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">21.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">22.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">23.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">24.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">25.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">26.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">27.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">28.0</span><span style="color:#000;font-weight:bold">},</span>
				<span style="color:#000;font-weight:bold">},</span>
				<span style="color:#000">LsnContext</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">LsnContext</span><span style="color:#000;font-weight:bold">{</span> <span style="color:#8f5902;font-style:italic">// With valid context
</span><span style="color:#8f5902;font-style:italic"></span>					<span style="color:#000">LSN</span><span style="color:#000;font-weight:bold">:</span>     <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
					<span style="color:#000">Context</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;write context hear&#34;</span><span style="color:#000;font-weight:bold">,</span>
				<span style="color:#000;font-weight:bold">},</span>
			<span style="color:#000;font-weight:bold">}},</span>
		<span style="color:#000">RequestID</span><span style="color:#000;font-weight:bold">:</span>   <span style="color:#4e9a06">&#34;&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// Optional field
</span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">MagicNumber</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>  <span style="color:#8f5902;font-style:italic">// Optional field
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#8f5902;font-style:italic">// Write rows to collection
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">err</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Write</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rows</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Insert data to collection failed.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h2 id="4-文档查询">4. 文档查询</h2>
<h3 id="41-向量查询">4.1. 向量查询</h3>
<p><strong><u>Query(collection string, column string, features interface{}, opts &hellip;QueryOption) (*QueryResponse, error)</u></strong></p>
<p><em>单次、批量向BE发起向量查询请求，执行成功返回QueryResponse的有效指针，失败返回error</em></p>
<p><strong>参数说明：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>collection: </font></strong> <em><font color=#2f3f4f>string指定集合名称</font></em></li>
<li><strong><font color=#2f3f4f>column: </font></strong> <em><font color=#2f3f4f>string指定列名</font></em></li>
<li><strong><font color=#2f3f4f>features: </font></strong> <em><font color=#2f3f4f>指定查询向量，该参数可以是切片、数组、或者二维矩阵（每行一个向量），向量中的原始数据类型支持int8/uint32/uint64/float32中的一种（由于语言限制，如果索引创建时数据类型配置为DTVectorFP16，请使用float32类型与BE交互，服务器端会自动进行类型转换）</font></em></li>
<li><strong><font color=#2f3f4f>opts: </font></strong> <em><font color=#2f3f4f>QueryOption可选参数列表，可选的参数如下：</font></em>
<ul>
<li><strong><font color=#2f3f4f>WithTopK(int): </font></strong> <em><font color=#2f3f4f>最近的邻居个数</font></em></li>
<li><strong><font color=#2f3f4f>WithRadius(float32): </font></strong> <em><font color=#2f3f4f>搜索半径，可选区间为0~1的浮点数，越大召回效果上升、性能下降，越小召回效果下降、性能上升。当请求中同时打开暴力匹配选项，则此参数无效。</font></em></li>
<li><strong><font color=#2f3f4f>WithLinearSearch(): </font></strong> <em><font color=#2f3f4f>暴力匹配选项，返回的为绝对topk结果（性能最低）</font></em></li>
<li><strong><font color=#2f3f4f>WithDebugMode(): </font></strong> <em><font color=#2f3f4f>调试模式，将详细搜索的各阶段统计数据返回（不建议生产环境中打开）</font></em></li>
<li><strong><font color=#2f3f4f>WithParam(string, interface{}): </font></strong> <em><font color=#2f3f4f>高级检索参数，可选配置项待发布</font></em></li>
</ul>
</li>
</ul>
<p><strong>返回值：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>*QueryResponse: </font></strong> <em><font color=#2f3f4f>最近邻的documents结果</font></em></li>
<li><strong><font color=#2f3f4f>error: </font></strong> <em><font color=#2f3f4f>失败返回非nil</font></em></li>
</ul>
<p><em><strong>示例 1.1：</strong></em> <u>单次向量查询</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">fun</span> <span style="color:#000">queryDemo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ProximaSearchClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#8f5902;font-style:italic">// Query one vector
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">resp</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Query</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;example&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;column&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">float32</span><span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">6.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">7.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8.0</span><span style="color:#000;font-weight:bold">},</span> <span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithTopK</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">))</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Query failed.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Response: %+v\n&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">resp</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p><em><strong>示例 1.2：</strong></em> <u>批量向量查询</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">fun</span> <span style="color:#000">batchQueryDemo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ProximaSearchClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#8f5902;font-style:italic">// Query with matrix
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">resp</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Query</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;example&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;column&#34;</span><span style="color:#000;font-weight:bold">,</span>
		<span style="color:#000;font-weight:bold">[][]</span><span style="color:#204a87;font-weight:bold">float32</span><span style="color:#000;font-weight:bold">{{</span><span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">6.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">7.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8.0</span><span style="color:#000;font-weight:bold">},</span>
			<span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">6.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">7.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8.0</span><span style="color:#000;font-weight:bold">},</span>
			<span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">6.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">7.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8.0</span><span style="color:#000;font-weight:bold">},</span>
			<span style="color:#000;font-weight:bold">{</span><span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">3.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">4.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">5.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">6.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">7.0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">8.0</span><span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000;font-weight:bold">},</span>
		<span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithTopK</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">),</span>
		<span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithDebugMode</span><span style="color:#000;font-weight:bold">(),</span>    <span style="color:#8f5902;font-style:italic">// Enable debug mode, do not recommend on product environments
</span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithRadius</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1.5</span><span style="color:#000;font-weight:bold">),</span>    <span style="color:#8f5902;font-style:italic">// Search radius, no effect if sdk.WithLinearSearch enabled
</span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithLinearSearch</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#8f5902;font-style:italic">// Enable linear search
</span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithParam</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;customize_param&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">),</span>
		<span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithParam</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;customize_param2&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1.0</span><span style="color:#000;font-weight:bold">),</span>
		<span style="color:#000">sdk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WithParam</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;customize_param3&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;str&#34;</span><span style="color:#000;font-weight:bold">))</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Query failed.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Response: %+v\n&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">resp</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><h3 id="42-主键查询">4.2. 主键查询</h3>
<p><strong><u>GetDocumentByKey(collection string, primaryKey uint64) (*Document, error)</u></strong></p>
<p><em>通过文档主键获取文档，执行成功返回Document的有效指针，失败返回error</em></p>
<p><strong>参数说明：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>collection: </font></strong> <em><font color=#2f3f4f>集合名称</font></em></li>
<li><strong><font color=#2f3f4f>primaryKey: </font></strong> <em><font color=#2f3f4f>文档主键</font></em></li>
</ul>
<p><strong>返回值：</strong></p>
<ul>
<li><strong><font color=#2f3f4f>*Document: </font></strong> <em><font color=#2f3f4f>文档对象</font></em></li>
<li><strong><font color=#2f3f4f>error: </font></strong> <em><font color=#2f3f4f>失败返回非nil</font></em></li>
</ul>
<p><em><strong>示例 2.1：</strong></em> <u>根据文档主键获取文档内容</u></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000">fun</span> <span style="color:#000">queryDocByPKDemo</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ProximaSearchClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
	<span style="color:#8f5902;font-style:italic">// Retrieve document by primary key
</span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">doc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">GetDocumentByKey</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;example&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Failed to retrieve document from server.&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
	<span style="color:#000;font-weight:bold">}</span>
	<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Printf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Document: %+v\n&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">doc</span><span style="color:#000;font-weight:bold">)</span>

<span style="color:#000;font-weight:bold">}</span>
</code></pre></div>
</div>



    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/alibaba/proximabilin.git" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Developer mailing list(TODO&lt;cdz&gt;: Change later)" aria-label="Developer mailing list(TODO&lt;cdz&gt;: Change later)">
    <a class="text-white" target="_blank" rel="noopener" href="https://example.org/mail" aria-label="Developer mailing list(TODO&lt;cdz&gt;: Change later)">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2021 The Proxima Bilin Engine Authors All Rights Reserved</small>
        <small class="ml-1"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener">隐私政策</a></small>
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>





<script src='/js/tabpane-persist.js'></script>




 














<script src="/js/main.min.3b172c13b62c2bea8b1c9d2599cddc8cf89718a92d792c680871c81ba43d8c85.js" integrity="sha256-OxcsE7YsK&#43;qLHJ0lmc3cjPiXGKkteSxoCHHIG6Q9jIU=" crossorigin="anonymous"></script>




  </body>
</html>
